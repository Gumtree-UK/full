<!---

Change log;
- 2015-05-19 - Task #5285: GTCRM-1896 - Product Configuration: Auto-revert to top tier pricing
- 2015-05-19 - Task #5285: GTCRM-2002 - Pre-populate quantity from default on product

--->

<apex:page standardController="Opportunity" extensions="ModifyProductController2" Sidebar="false" showHeader="true" id="myPage" tabstyle="Opportunity" action="{!createDefaultGeoNames}">
    
    <head>
      <apex:styleSheet value="{!URLFOR($Resource.JQ_Spinner, '/jquery-ui-1.10.3.custom/development-bundle/themes/base/jquery.ui.all.css')}" />
        <apex:includeScript value="{!URLFOR($Resource.JQ_Spinner, '/jquery-ui-1.10.3.custom/development-bundle/jquery-1.9.1.js')}" />
        <apex:includeScript value="{!URLFOR($Resource.JQ_Spinner, '/jquery-ui-1.10.3.custom/development-bundle/external/jquery.mousewheel.js')}" />
        <apex:includeScript value="{!URLFOR($Resource.JQ_Spinner, '/jquery-ui-1.10.3.custom/development-bundle/ui/jquery.ui.core.js')}" />
        <apex:includeScript value="{!URLFOR($Resource.JQ_Spinner, '/jquery-ui-1.10.3.custom/development-bundle/ui/jquery.ui.widget.js')}" />
        <apex:includeScript value="{!URLFOR($Resource.JQ_Spinner, '/jquery-ui-1.10.3.custom/development-bundle/ui/jquery.ui.button.js')}" />
        <apex:includeScript value="{!URLFOR($Resource.JQ_Spinner, '/jquery-ui-1.10.3.custom/development-bundle/ui/jquery.ui.spinner.js')}" />
        
        <style type="text/css">
            .dateFormat {
                display:none;
            }
            .activeTab {
                background-color: #FDD017;
                color:white;
                background-image:none
            }
            .inactiveTab {
                background-color: #F3F3EC;
                color:black;
                background-image:none
            }
            .colHeader {
                font-weight:bold;
                border-bottom:1px solid #E3DEB8;
            }
            .colContent {
                border-bottom:1px solid #E3DEB8
            }
            html, body {
                // overflow-x: hidden;
            }
            .visibleDiv {
                border:1px solid gray;
                width:125px;
                background:#9E9E9E;
                height: 18px;
                text-align:left;
                padding-left:2px;
            }
            
            table#HourOfDayTable{
  font-size: 10px; 
}
table#HourOfDayTable div{
  height: 13px;  
} 
table#HourOfDayTable a{
  text-decoration:underline;
  color:blue; 
}
table#HourOfDayTable a, img{
   cursor:pointer;
}
table#HourOfDayTable a.TimeTargetingSelect4Hours{
   hight:15px;
   width:15px;
   margin-right: 3px; 
   text-decoration:none;
   vertical-align:top;
   /*
   opacity:0.4;
   filter:alpha(opacity=40);   For IE8 and earlier */
}
table#HourOfDayTable a.TimeTargetingSelect4Hours:hover{
   opacity:1.0;
   filter:alpha(opacity=100); /* For IE8 and earlier */
}
table#HourOfDayTable a:hover, img:hover{ 
  background-color:#ACF7AC;
  font-weight:bold; 
}
table#HourOfDayTable img:hover{
  border-right:1px solid #0000ff;
  border-left:1px solid #0000ff;  
   opacity:1.0; 
  filter:alpha(opacity=100); /* For IE8 and earlier */
}
table#HourOfDayTable img{ 
  margin:1px;
  width:16px;
  high:12px;
  /*
  opacity:0.5;
  filter:alpha(opacity=50);   For IE8 and earlier */   
} 
table#HourOfDayTable span.oldTimeTargeting{
  background-color:yellow;
}
table#HourOfDayTable span.oldTimeTargeting img{
  background-color:yellow;
  opacity:0.8;
  filter:alpha(opacity=80);   /* For IE8 and earlier */  
} 
table#HourOfDayTable span:hover{
  /*background-color:green;*/
}   
table#HourOfDayTable th{
  background-color: rgb(221, 185, 41);
  margin: 0px 5px 0px 0px;
} 

            
            .mousehover {
                cursor:pointer;
            }
            div .enableStyle {
                background: url("/img/alohaSkin/btn_important.png") repeat-x scroll 0 0 transparent;
                border: 0 none;
                background-repeat: repeat-x;
                border-radius: 5px 5px 5px 5px;
                border-style: none;
                box-shadow: 0 2px 4px #AAAAAA;
                color: #FFFFFF;
                font-size: 0.95em;
                height: 21px;
                padding: 0 7px 3px;
                font-family: Arial, Helvetica, sans-serif;
            }
            body .btnDisabled:hover {
                background-position:0 0px;
            }
            div .enableStyle:hover {
                background-position:right -40;
                cursor:default;
            }
            div .enableStyle2 {
                background: url("/img/alohaSkin/btn_important.png") repeat-x scroll 0 0 transparent;
                border: 0 none;
                background-repeat: repeat-x;
                border-radius: 5px 5px 5px 5px;
                border-style: none;
                box-shadow: 0 2px 4px #AAAAAA;
                color: #FFFFFF;
                font-size: 0.95em;
                height: 21px;
                padding: 0 7px 3px;
                cursor: pointer;
                font-family: Arial, Helvetica, sans-serif;
            }
            div .btnNotDisplaying {
                border: 0 none;
                background-repeat: repeat-x;
                border-radius: 5px 5px 5px 5px;
                border-style: none;
                box-shadow: 0 2px 4px #AAAAAA;
                font-size: 0.95em;
                height: 20px;
                padding: 0 7px 2px;
                cursor: pointer;
                font-family: Arial, Helvetica, sans-serif;
            }
            div .disableStyle {
                background: none;
                border: 0 none;
                border-radius: 5px 5px 5px 5px;
                border-style: none;
                box-shadow: 0 2px 4px #AAAAAA;
                color: #909090;
                font-size: 0.95em;
                height: 20px;
                padding: 0 7px 2px;
                cursor:default;
                font-family: Arial, Helvetica, sans-serif;
                disabled:true;
            }
            .ui-corner-all {
                border-bottom-right-radius: 0;
                border-bottom-left-radius: 0;
                border-top-right-radius: 0;
                border-top-left-radius: 0;
                margin-bottom: 2px;
            }
        </style>
        
        <script type="text/javascript">
            
            // --------Run when the row+color header of the table clicked--------  
    function checkAllHours(index){  
      var theHiddenInput = getTheHiddenInput(index); 
      var days = new Array("mon","tue","wed","thu","fri","sat","sun");
      
      // get the first hour status for using in loop 
      var checkBoxImg = getCheckBoxImg(index, ("mon0")) ;
      var isChecked = getCheckState(checkBoxImg);
      
      for(var i = 0; i < 24; i++){
        for(var d = 0; d < days.length; d++){
          var checkBoxImg = getCheckBoxImg(index, (days[d] + i) );
          checkHour(checkBoxImg, theHiddenInput, !isChecked);
        }
      } 
    }
     
  // --------Run when the row header of the table clicked--------  
    function checkEntireRow(day3char, index){ 
      var theHiddenInput = getTheHiddenInput(index);
      
      // get the first hour status for using in loop 
      var checkBoxImg = getCheckBoxImg(index, (day3char + 0)) ;
      var isChecked = getCheckState(checkBoxImg);
      
      for(var i = 0; i < 24; i++){
        var checkBoxImg = getCheckBoxImg(index, (day3char + i)) ;
        checkHour(checkBoxImg, theHiddenInput, !isChecked);
      } 
    }
    
    // --------Run when the column header of the table clicked-------- 
    function checkEntireHourBlock(firstHour, index){
      var theHiddenInput = getTheHiddenInput(index); 
      var days = new Array("mon","tue","wed","thu","fri","sat","sun");
      
      // get the first hour status for using in loop 
      var checkBoxImg = getCheckBoxImg(index, ("mon" + firstHour)) ;
      var isChecked = getCheckState(checkBoxImg);
      
      for(var i = 0; i < 4; i++){
        for(var d = 0; d < days.length; d++){
          var checkBoxImg = getCheckBoxImg(index, (days[d] + (i+firstHour)) );
          checkHour(checkBoxImg, theHiddenInput, !isChecked);
        }
      }
      
    }
    
    // --------Run when the image infront of the 4 hours clicked-------- 
    function check4Hour(day3char, firstHour, index){
      var theHiddenInput = getTheHiddenInput(index);
       
      // get the first hour status for using in loop 
      var checkBoxImg = getCheckBoxImg(index, (day3char + firstHour)) ;
      var isChecked = getCheckState(checkBoxImg);
      
      for(var i = 0; i < 4; i++){ 
         var checkBoxImg = getCheckBoxImg(index, (day3char + (i+firstHour)) );
         checkHour(checkBoxImg, theHiddenInput, !isChecked); 
      } 
    }
    
    // --------Run when checkBoxImg clicked-------- 
    function checkHourOfDayOnClick(checkBoxImg, index){
      var theHiddenInput = getTheHiddenInput(index);  
        if( getCheckState(checkBoxImg) ){ 
          checkHour(checkBoxImg, theHiddenInput, false);
        }else{ 
          checkHour(checkBoxImg, theHiddenInput, true);
        }  
    }
     
    // --------Run when page load or rerender-------- 
    function checkHourOfDayOnload(index, isOldTimeTargating){ 
      var theHiddenText = getTheHiddenInput(index).value; 
      var checkBoxImgIDs = theHiddenText.split(',');
      
      // remove empty values
      for(var i = 0; i < checkBoxImgIDs.length; i++){
        if(checkBoxImgIDs[i] == ''){
          checkBoxImgIDs.splice(i, 1);
        }
      }
      // checked the checkboxs 
      for(var i = 0; i < checkBoxImgIDs.length; i++){
        var checkBoxImg = getCheckBoxImg(index, checkBoxImgIDs[i]); 
        checkBoxImg.src = "{!URLFOR($Resource.CheckBox, '/checked.gif')}";
         
        //Highlight the checkbox that is the old time targeting 
        if(isOldTimeTargating == 'true'){ 
          var span = checkBoxImg.parentNode;
          span.className = 'oldTimeTargeting';
        } 
      } 
    }
    
    // ------------ Utility ------------
    function getTheHiddenInput(index){
      index = checkCurrentPosition(index);
      var theHiddenText = document.getElementById('myPage:myForm:MyPageBlock:myRepeat4:'+ index + ':theHiddenText');
      return theHiddenText;
    }
     
    // ------------ Utility ------------
    function getCheckBoxImg(index, checkBoxImgID){
      index = checkCurrentPosition(index);
      var checkBoxImg = document.getElementById('myPage:myForm:MyPageBlock:myRepeat4:' + index + ':' + checkBoxImgID);
      return checkBoxImg;
    }
    
    // ------------ Utility ------------
    function getCheckState(checkBoxImg){
      var imgName = checkBoxImg.src.substring(checkBoxImg.src.lastIndexOf('/')+1);  
        return (imgName == 'checked.gif'); 
    }
    
    // ------------ Utility ------------
    function checkHour(checkBoxImg, theHiddenInput, isCheck){ 
      var theHiddenText = theHiddenInput.value; 
      
      var id = checkBoxImg.getAttribute('id');
    id = id.substring( id.lastIndexOf(':')+1 );
    
    if(isCheck){
      checkBoxImg.src = "{!URLFOR($Resource.CheckBox, '/checked.gif')}";
      theHiddenText = theHiddenText.replace( (id + ','), ''); 
      theHiddenText += (id + ',');
    }else{
      checkBoxImg.src = "{!URLFOR($Resource.CheckBox, '/unchecked.gif')}";
      theHiddenText = theHiddenText.replace( (id + ','), ''); 
    } 
        theHiddenInput.value = theHiddenText;
    }
     
  //===================================================
            
            var jq = jQuery.noConflict();

            function changeBC(index, fixedPrice) {


                index = checkCurrentPosition(index);

                var sp = document.getElementById('myPage:myForm:MyPageBlock:myRepeat2:' + index + ':Sales_Price');
                var bc = document.getElementById('myPage:myForm:MyPageBlock:myRepeat2:' + index + ':BillingCategory');
                var qt = document.getElementById('myPage:myForm:MyPageBlock:myRepeat2:' + index + ':Quantity');


                var a = bc.value;
                var b = 'fix price';
                var c = 'cpm';


                if (fixedPrice == 'true') {

                    if (a.toLowerCase() == b.toLowerCase() || a.toLowerCase() == c.toLowerCase()) {

                        sp.disabled = true;
                    } else {

                        sp.disabled = false;
                    }
                }
                if (a.toLowerCase() == b.toLowerCase() && qt.value == '') {

                    qt.value = 1;
                }
            }

            function getWidth() {
                return (typeof window.innerWidth != 'undefined' ? window.innerWidth : document.documentElement.clientWidth);
            }

            function setPosition(value) {
                var doc = document.getElementById("myPage:myForm:SelPosition");
                doc.value = value;
            }

            function setToDate(index) {

                var start = document.getElementById('myPage:myForm:MyPageBlock:myRepeat1:' + index + ':startDate').value;
                var end = document.getElementById('myPage:myForm:MyPageBlock:myRepeat1:' + index + ':endDate').value;

                if (start != '' && end == '') {
                    document.getElementById('myPage:myForm:MyPageBlock:myRepeat1:' + index + ':endDate').value = start;
                    DatePicker.pickDate(true, 'myPage:myForm:MyPageBlock:myRepeat1:' + index + ':endDate', false);
                }

            }

            function setColumn(value) {
                var doc = document.getElementById("myPage:myForm:SelColumn");
                doc.value = value;
            }

            function cancel() {
                document.getElementById('overlayBackground').style.display = 'none';
                document.getElementById('InlineEditDialog').style.display = 'none';

            }

            function cancelCx() {
                document.getElementById('overlayBackground').style.display = 'none';
                document.getElementById('InlineCopyDialog').style.display = 'none';

            }

            function days_between(date1, date2) {
                // The number of milliseconds in one day
                var ONE_DAY = 1000 * 60 * 60 * 24;
                // Convert both dates to milliseconds
                var date1_ms = date1.getTime();
                var date2_ms = date2.getTime();
                // Calculate the difference in milliseconds
                var difference_ms = Math.abs(date1_ms - date2_ms);
                // Convert back to days and return
                return Math.round(difference_ms / ONE_DAY);

            }

            function setShare(value) {
                var doc = document.getElementById("myPage:myForm:SelShare");
                doc.value = value;
            }

            mDaysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

            function daysInMonth(month, year) {
                if ((month == 1) && (year % 4 == 0) && ((year % 100 != 0) || (year % 400 == 0))) {
                    return 29;
                } else {
                    return mDaysInMonth[month];
                }
            }

            function IsDateEqual(Date1, Date2) {
                var DaysDiff;
                DaysDiff = Math.floor((Date1.getTime() - Date2.getTime()) / (1000 * 60 * 60 * 24));
                if (DaysDiff == 0)
                    return true;
                else
                    return false;
            }

            var position;

            function loadCx(proName, index) {

                position = index;
                var title = document.getElementById('InlineCopyDialogTitle');
                title.innerHTML = proName;
                var radioStr = '';
                var newdiv = document.getElementById('contentCopy');

                newdiv.innerHTML = '<tr><td>{!$Label.HowManyCopies}&nbsp;&nbsp;<input id="copies" name="copies" type="input"></td></tr>';
            }

            function editBlockOpenCx() {
                var divOverLay = document.getElementById('overlayBackground');
                var divObj = document.getElementById('InlineCopyDialog')
                divOverLay.style.display = 'inline';
                divObj.style.display = 'inline';
            }


            function loadRadio(proName, index) {
                index = checkCurrentPosition(index);
                position = index;
                var start = document.getElementById('myPage:myForm:MyPageBlock:myRepeat1:' + index + ':startDate').value;
                var end = document.getElementById('myPage:myForm:MyPageBlock:myRepeat1:' + index + ':endDate').value;
                var title = document.getElementById('InlineEditDialogTitle');
                title.innerHTML = proName;
                var radioStr = '';
                var newdiv = document.getElementById('content');

                if (start == '' || end == '') {

                    radioStr = '{!$Label.NoShare}';

                } else {

                    var temp1 = new Array();
                    if (start.indexOf('.') != -1) {
                        temp1 = start.split('.');
                    } else if (start.indexOf('/') != -1) {
                        temp1 = start.split('/');
                    }

                    var temp2 = new Array();
                    if (end.indexOf('.') != -1) {
                        temp2 = end.split('.');
                    } else if (end.indexOf('/') != -1) {
                        temp2 = end.split('/');
                    }

                    var startDate = new Date(temp1[2] + '/' + temp1[1] + '/' + temp1[0]);
                    var endDate = new Date(temp2[2] + '/' + temp2[1] + '/' + temp2[0]);

                    var lastDate;
                    var lastmonth = tmpStart;
                    radioStr = '<table>';
                    var lastSun;
                    var tmpStart = startDate;
                    var weeks = 0;
                    var weeks2 = 0;
                    var months = 0;
                    while (tmpStart <= endDate) {
                        if (tmpStart.getDay() == 0) {
                            weeks = weeks + 1;
                            lastSun = tmpStart;
                        }

                        lastDate = new Date(tmpStart.getFullYear(), tmpStart.getMonth(), daysInMonth((tmpStart.getMonth()), tmpStart.getFullYear()));
                        if (IsDateEqual(tmpStart, lastDate)) {
                            months = months + 1;
                            lastmonth = tmpStart;

                        }

                        tmpStart = new Date(tmpStart.getTime() + (24 * 60 * 60 * 1000));
                    }

                    if (lastmonth < endDate) {
                        months = months + 1;
                    }
                    if (lastSun < endDate) {
                        weeks = weeks + 1;
                    }
                    weeks2 = Math.ceil(weeks / 2);


                    if (weeks > 1) {
                        radioStr = radioStr + '<tr><td><input  name="group" type="radio" onclick="setShare(\'week\')"  />{!$Label.WeekShare} (' + weeks + ' {!$Label.Products})</input></td></tr>';
                    }
                    if (weeks2 > 1) {
                        radioStr = radioStr + '<tr><td><input  name="group" type="radio" onclick="setShare(\'week2\')"  />{!$Label.Week2Share} (' + weeks2 + ' {!$Label.Products})</input></td></tr>';
                    }


                    if (months > 1) {
                        radioStr = radioStr + '<tr><td><input  name="group" type="radio" onclick="setShare(\'month\')"   />{!$Label.MonthShare}  (' + months + ' {!$Label.Products})</input>  </td></tr>';
                    }
                    radioStr = radioStr + '</table>';
                    if (radioStr == '<table></table>') {
                        radioStr = '{!$Label.NoShare}';
                    }
                }
                newdiv.innerHTML = radioStr;


            }

            function setWidthDiv(val) {
                var mydiv = document.getElementById(val);
                mydiv.style.width = (getWidth() - 485) + 'px';
                //mydiv.style.word-wrap= 'break-word';

            }

            function editBlockOpen() {
                var divOverLay = document.getElementById('overlayBackground');
                var divObj = document.getElementById('InlineEditDialog');
                divOverLay.style.display = 'inline';
                divObj.style.display = 'inline';
            }

            function trim(str) {
                var reExtraSpace = /^\s+(.*?)\s+$/;
                str = str.replace(reExtraSpace, '$1');
                return str.replace(' ', '');
            }


            function checkCurrentPosition(p) {
            
                var maxRec = '{!MAXRECORD}';
                
                //alert('*****p:'+p+'>>>>>>:MAXRECORD:'+maxRec);
                //NK:05/02/2014: added '=' to '>' -> '>=' to fix next page that not able to open tree popup due to wrong id field by index
                if (p >= maxRec) {
                    var pn = document.getElementById('myPage:myForm:MyPageBlock:PageNum').value;
                    
                    //alert('*****>>>:pn:'+pn);
                    p = p - ((pn * maxRec) - maxRec);
                }
                return p;
            }


            function checkValidationCopyField(p, n, i) {
                p = checkCurrentPosition(p);
                var compo = document.getElementById('myPage:myForm:MyPageBlock:myRepeat' + i + ':' + p + ':' + n).value;
                //cut all space throw aways

                compo = trim(compo);

                if (compo != '') {
                    copyField();
                }
            }


            function checkValidationCopyField2(p, n, i) {
                p = checkCurrentPosition(p);

                var txtSP = document.getElementById('myPage:myForm:MyPageBlock:myRepeat' + i + ':' + p + ':' + n);
                if (txtSP.disabled == false) {
                    var compo = document.getElementById('myPage:myForm:MyPageBlock:myRepeat' + i + ':' + p + ':' + n).value;
                    //cut all space throw aways
                    compo = trim(compo);
                    //alert(compo);
                    if (compo != '') {
                        copyField();
                    }
                }
            }


            function forceCopyField(p, n, i) {
                p = checkCurrentPosition(p);
                var compo = document.getElementById('myPage:myForm:MyPageBlock:myRepeat' + i + ':' + p + ':' + n).value;
                //cut all space throw aways
                compo = trim(compo);
                //alert(compo);
                if (compo != '') {
                    forceCopyFieldCon();
                }

            }

            function forceCopyField2(p, n, i) {
                p = checkCurrentPosition(p);
                var txtSP = document.getElementById('myPage:myForm:MyPageBlock:myRepeat' + i + ':' + p + ':' + n);
                if (txtSP.disabled == false) {
                    var compo = document.getElementById('myPage:myForm:MyPageBlock:myRepeat' + i + ':' + p + ':' + n).value;
                    //cut all space throw aways
                    compo = trim(compo);
                    //alert(compo);
                    if (compo != '') {
                        forceCopyFieldCon();
                    }
                }
            }

            function checkValidationSplit() {
                var start = document.getElementById('myPage:myForm:MyPageBlock:myRepeat1:' + position + ':startDate').value;
                var end = document.getElementById('myPage:myForm:MyPageBlock:myRepeat1:' + position + ':endDate').value;
                if (start != '' && end != '') {
                    split();
                }
            }

            function checkValidationCopy() {
                try {
                    var copies = document.getElementById('copies').value;
                    if (copies != '' && copies > 0) {
                        var doc = document.getElementById("myPage:myForm:MyPageBlock:SelCopies");
                        doc.value = copies;
                        copy();
                    }
                } catch (e) {
                    alert(e);
                }
            }

            function isIE() {
                return /msie/i.test(navigator.userAgent) && !/opera/i.test(navigator.userAgent);
            }


            function getTargetingTreePopup(i, p, s) {
                //alert('before:> i:'+i+'>>>>>:p: '+p+'>>>>>>s:'+s);
                p = checkCurrentPosition(p);
                //alert('>>>>>>>>>>p after:'+p);
                openTargetingTreePopup(i, 'myPage:myForm:MyPageBlock:myRepeat6:' + p + ':hidTargetId', s)
            }

            function putAvailableSiteToFixedSite(p, isFix) {
                p = checkCurrentPosition(p);
                var avaiValue = '';
                avaiValue = document.getElementById('myPage:myForm:MyPageBlock:myRepeat6:' + p + ':hidAvail');
                var tarValue = document.getElementById('myPage:myForm:MyPageBlock:myRepeat6:' + p + ':txaTarget');
                if (tarValue.value == '' || tarValue.value == null) {
                    if (isFix == 'true') {
                        tarValue.value = avaiValue.value;
                    }
                }
            }

            function onload() {
                //alert('first: ' + window.screen.availWidth);

                var divOverLay = document.getElementById("myPage:myForm:MyPageBlock");
                var div1 = document.getElementById("mydev1");
                var div2 = document.getElementById("mydevPrice");
                var div3 = document.getElementById("mydev3");
                var div4 = document.getElementById("mydev4");
                var div5 = document.getElementById("mydev5");
                var div6 = document.getElementById("mydev6");
                var div7 = document.getElementById("mydev7");
               // var div8 = document.getElementById("mydev8");
                var div9 = document.getElementById("mydev9");
                
                div1.style.width = (window.screen.availWidth - 465) + "px";
                div2.style.width = (window.screen.availWidth - 465) + "px"; 
                div3.style.width = (window.screen.availWidth - 465) + "px";
                div4.style.width = (window.screen.availWidth - 465) + "px";
                div5.style.width = (window.screen.availWidth - 465) + "px";
                div6.style.width = (window.screen.availWidth - 465) + "px";
                div7.style.width = (window.screen.availWidth - 465) + "px";
               // div8.style.width = (window.screen.availWidth - 465) + "px";
                div9.style.width = (window.screen.availWidth - 465) + "px";
                divOverLay.style.width = (window.screen.availWidth - 63) + "px";
            }

            function mergeKVKW(p) {
                p = checkCurrentPosition(p);
                var kv = document.getElementById('myPage:myForm:MyPageBlock:myRepeat6:' + p + ':keyvalueString');
                var kw = document.getElementById('myPage:myForm:MyPageBlock:myRepeat4:' + p + ':keyword');
                var fk = document.getElementById('myPage:myForm:MyPageBlock:myRepeat9:' + p + ':finalKey');

                if (kv.value == '' || kv.value == null) {
                    fk.value = kw.value;
                } else if (kw.value == '' || kw.value == null) {
                    fk.value = kv.value;
                } else if (kv.value != '' && kv.value != null && kw.value != '' && kw.value != null) {
                    fk.value = '(' + kv.value + ') AND (' + kw.value + ')';
                }
            }

            function disableInputField(p, typeOfField, idField, repeatNum) {
                p = checkCurrentPosition(p);
                var c = document.getElementById('myPage:myForm:MyPageBlock:' + repeatNum + ':' + p + ':' + idField);
                if (typeOfField == 'false') {
                    c.disabled = true;
                }
            }
            
            function disableMultiSelect(pos, isDisable, idField, repeatId){
                try{
                
                
                pos = checkCurrentPosition(pos);
                var id_elem = 'myPage:myForm:MyPageBlock:' + repeatId + ':' + pos + ':' + idField;
                var id_unselected = id_elem + '_unselected';
                var id_selected = id_elem + '_selected';
                var id_right_arrow = id_elem + '_right_arrow';
                var id_left_arrow = id_elem + '_left_arrow';
                
                var mainField = document.getElementById(id_elem);
                var unselectedField = document.getElementById(id_unselected);
                var selectedField = document.getElementById(id_selected);
                var right_arrow = document.getElementById(id_right_arrow);
                var left_arrow = document.getElementById(id_left_arrow);
                
                if (isDisable == 'false') {
                    mainField.disabled = true;
                    unselectedField.disabled = true;
                    unselectedField.style.marginRight = '20px';
                    selectedField.disabled = true;
                    right_arrow.style.display = 'none';
                    left_arrow.style.display = 'none';
                }
                }catch(e){
                    alert('errr2:'+e);
                }
            }
            function visibleSpinner(val, gbpId, spinnerId) {
                var elem_gbp = document.getElementById(gbpId);
                var elem_percent = document.getElementById(spinnerId);

                elem_gbp.style.display = (val == '{!GBP_TYPE}' ? '' : 'none');
                elem_percent.style.display = (val == '{!PERCENT_TYPE}' ? '' : 'none');
            }

            function fillValue2Spinner(val, spinnerId, index) {
                document.getElementById(spinnerId).value = val;
            }
            
            //HCS 11.04.2014 open new targeting
            function opeNewTargetingPopup(proId,itemId,pos){
                 var width = 760;
                var height = 550;
                var left = (screen.width - width) / 2;
                var top = (screen.height - height) / 2;
                var params = 'width=' + width + ', height=' + height;
                params += ', top=' + top + ', left=' + left;
                params += ', directories=no'; 
                params += ', location=no'; 
                params += ', menubar=no';
                params += ', resizable=no';
                params += ', scrollbars=no';
                params += ', status=no';
                params += ', toolbar=no';   
                pos =  checkCurrentPosition(pos);
                var targetingId = document.getElementById('myPage:myForm:MyPageBlock:myRepeat6:'+pos +':hidTargetId').value;
                
                var url = '/apex/TreeSelectingView?proId='+ proId   +'&itemId='+ itemId +'&targetId='+ targetingId+ '&pos='+ pos +'&froIfr=true';
                var newwin = window.open(url, 'TreeProduct', params);
                if(window.focus) {
                    newwin.focus();
                }
            
            }        
            
        </script>
    </head>
    <div class="bPageTitle">
        <div class="ptBody secondaryPalette">
            <div class="content">
                <apex:image id="theImage" value="/s.gif" styleClass="pageTitleIcon" />
                <apex:outputPanel >
                     <h2 class="pageType"><apex:outputText value="Opportunity Name: {!mcName}"/></h2>

                     <h1 class="pageDescription"><apex:outputText value="Account Name: {!accName}"/></h1>

                </apex:outputPanel>
            </div>
        </div>
    </div>
    <apex:form id="myForm">
        <apex:InputHidden id="SelPosition" value="{!selPosition}" />
        <apex:InputHidden id="SelColumn" value="{!selColumn}" />
        <apex:InputHidden id="SelShare" value="{!selShare}" />
        <apex:InputHidden id="uAgent" value="{!hsize}" />
        <apex:InputHidden id="prodcount" value="{!prodcount}" />
        <apex:actionFunction name="saveRecords" action="{!saveRecords}" rerender="MyPageBlock,SaveAsPoller,theWaitingProgress" status="status" />
        <apex:actionFunction name="copyField" action="{!copyField}" rerender="MyPageBlock" status="status" />
        <apex:actionFunction name="forceCopyFieldCon" action="{!forceCopyField}" rerender="MyPageBlock" status="status" />
         <apex:actionFunction name="doCopyForNewTargeting" action="{!doCopyForNewTargeting}" rerender="MyPageBlock" status="status" />
          <apex:actionFunction name="doForceCopyForNewTargeting" action="{!doForceCopyForNewTargeting}" rerender="MyPageBlock" status="status" />
        <apex:actionFunction name="copy" action="{!copyRecords}" rerender="MyPageBlock" status="status" />
        <apex:actionFunction name="doCalculateNetNetNet" action="{!calculateNetNetNet}" rerender="theTabPanel" status="status" />
         <apex:actionPoller action="{!saveRecords}" enabled="{!isPollerMode}" reRender="theInfoSection,theWaitingProgress" interval="5" id="SaveAsPoller"   />
            
        <apex:pageBlock id="MyPageBlock" title="{!$Label.BlockTitle}">
            <apex:InputHidden id="SelCopies" value="{!selCopies}" />
            <apex:inputHidden value="{!pageNum}" id="PageNum" />
            <!-- Use for tooltip on product name -->
            <apex:outputPanel layout="block" style="z-index:10000;" id="thePanel2">
                <apex:outputLabel id="theLabel2" />
            </apex:outputPanel>
            <apex:pageBlockButtons >
                <apex:commandButton value="{!$Label.Save}" title="{!$Label.Save}" action="{!saveRecords}" rerender="MyPageBlock,SaveAsPoller,theWaitingProgress" status="status" />
                <apex:commandButton value="{!$Label.Back}" title="{!$Label.Back}" action="{!goBack}" immediate="true" rerender="MyPageBlock" status="status" />
                <apex:commandButton value="Clear all" title="Clear all" onClick="window.location='{!refreshUrl}';return false;" />
                
                <apex:commandButton value="Calculate all" title="Calculate all" action="{!reCalculateAll}" rerender="theTabPanel" status="status" />
            </apex:pageBlockButtons>
            <div class="pbSubheader first tertiaryPalette"> 
                    <span class="pbSubExtra"><nobr>
                        <span class="requiredLegend">
                            <span class="requiredExampleOuter">
                                <span class="requiredExample">&nbsp; </span>
                            </span> 
                            <span class="requiredMark">*</span>  
                            <span class="requiredText"> = Required Information</span>
                        </span>
                    </nobr>
                    </span>
                 <h3>
                Information             
                </h3> 
            </div>
             <apex:InputHidden id="fromDateStatus" value="{!fromDateError}" />
            <apex:InputHidden id="forceSave" value="{!forceDateSave}" />
            <apex:InputHidden id="errorField" value="{!errorFieldStatus}" />
            <apex:InputHidden id="BPCollision" value="{!BP_Collision}" />
            <apex:outputPanel id="theInfoSection">
                <apex:pageMessage severity="warning" summary="{!warningOli}" rendered="{!If(warningOli<> '' , true, false)}" strength="3" ></apex:pageMessage>
                <apex:pageMessage severity="error" summary="{!errorMsg}" rendered="{!If(errorMsg<>'',true,false)}" strength="3"  ></apex:pageMessage>
           
           
            
            <script type="text/javascript">
                //call when got error from date < today
                var fromDate = document.getElementById("myPage:myForm:MyPageBlock:fromDateStatus").value;
                var forceSave = document.getElementById("myPage:myForm:MyPageBlock:forceSave");
                var errorField = document.getElementById("myPage:myForm:MyPageBlock:errorField").value;
                var BPCollision = document.getElementById("myPage:myForm:MyPageBlock:BPCollision").value;

                if (fromDate == 'true' && errorField == 'false') {
                    var ans;
                    ans = window.confirm('{!$Label.Error_date}');


                    if (ans == true) {
                        forceSave.value = true;
                        saveRecords();
                    }

                } else if (BPCollision != '') {
                    window.alert('Belegungsplan Kollision\n\n' + BPCollision);
                    forceSave.value = true;
                    saveRecords();
                }
            </script>
             </apex:outputPanel>
            <!-- HCS 29.04.2014 fixed not show scroll bar. change from  overflow: hidden-->
            <div style="overflow-y: hidden; overflow-x:auto;" id="divtab">
                <table cellpadding="0" cellspacing="0" width="100%">
                    <tr style="vertical-align:top">
                        <td width="20%">
                            <table style="margin-top:24px;background-color:#F3F3EC" cellpadding="0" cellspacing="0" width="370px">
                                <tr style="height:{!hsize}" id="header">
                                    <td align="center" style="font-weight:bold;border-bottom:1px solid #E3DEB8;">{!$Label.Product_Name}</td>
                                    <td align="center" style="font-weight:bold;border-bottom:1px solid #E3DEB8;">&nbsp;</td>
                                </tr>
                                <!-- <apex:repeat value="{!lstRecords}" var="rec"> -->
                                <apex:repeat value="{!lDisplayRec}" var="rec" >
                              <!--  <apex:repeat value="{!mapContentRecords[pageNum]}" var="rec">-->
                                    <tr style="height:106px">
                                            <!-- <td  width="280px" style="border-bottom:1px solid #E3DEB8;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word;"><apex:outputLabel id="proName"  value="{!rec.position+1}) {!rec.productName}" onmouseout="closeMessage('myPage:myForm:MyPageBlock:thePanel2');" onmouseover="changeTextValue('{!$ObjectType.OpportunityLineItem.Fields.Description.label}: {!rec.descr} \n {!$ObjectType.OpportunityLineItem.Fields.from_Date__c.label}: {!rec.fromDate} \n {!$ObjectType.OpportunityLineItem.Fields.until_Date__c.label}: {!rec.untilDate} \n {!$ObjectType.OpportunityLineItem.Fields.Quantity.label}: {!rec.quantity} \n {!$ObjectType.OpportunityLineItem.Fields.Targeting__c.label}: {!rec.targeting_c}','myPage:myForm:MyPageBlock:theLabel2','myPage:myForm:MyPageBlock:thePanel2',0,20);" styleclass="mousehover"> -->
                                            <td  width="280px" style="border-bottom:1px solid #E3DEB8;height:25px;">
                                                <table>
                                                    <tr>
                                                        <td>
                                                        <apex:outputLabel id="proName" value="{!rec.position+1}) {!rec.productName}" onmouseout="closeMessage('myPage:myForm:MyPageBlock:thePanel2');" onmouseover="changeTextValue('{!$ObjectType.OpportunityLineItem.Fields.Description.label}: {!rec.descr} \n {!$ObjectType.OpportunityLineItem.Fields.from_Date__c.label}: {!rec.fromDate} \n {!$ObjectType.OpportunityLineItem.Fields.until_Date__c.label}: {!rec.untilDate} \n {!$ObjectType.OpportunityLineItem.Fields.Quantity.label}: {!rec.quantity} \n {!$ObjectType.OpportunityLineItem.Fields.Targeting__c.label}: {!rec.targeting_c}','myPage:myForm:MyPageBlock:theLabel2','myPage:myForm:MyPageBlock:thePanel2',0,20);" styleclass="mousehover">
                                                        </apex:outputLabel>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <apex:outputLabel style="font-style: italic; font-size: 11px; color: gray;" id="proDesc"  value="{!rec.descr}">
                                                            </apex:outputLabel> 
                                                        </td>
                                                    </tr>
                                                    
                                                </table> 
                                                
                                            </td>
                                            <td align="center" style="border-bottom:1px solid #E3DEB8; " width="90px">                                                                             
                                                <apex:commandButton value="{!$Label.K}" action="{!duplicateRecord}"    rerender="MyPageBlock" status="status" title="{!$Label.DuplicationItem}">
                                                     <apex:param name="selPosition" value="{!rec.position}"  assignTo="{!selPosition}"/>
                                                </apex:commandButton>
                                                <apex:commandButton value="{!$Label.Kx}"  onmouseover="setPosition('{!rec.position}');"   onclick="loadCx('{!rec.productName}','{!rec.position}');editBlockOpenCx();return false;" title="{!$Label.DuplicationXItem}"/>
                                                <br/>
                                                <apex:commandButton value="{!$Label.L}" action="{!deleteRecord}"   rerender="MyPageBlock" status="status" title="{!$Label.DeleteItem}">
                                                        <apex:param name="selPosition" value="{!rec.position}"  assignTo="{!selPosition}"/>
                                                </apex:commandButton>
                                                <apex:commandButton value="{!$Label.V}"  onmouseover="setPosition('{!rec.position}');"   onclick="loadRadio('{!rec.productName}','{!rec.position}');editBlockOpen();return false;" title="{!$Label.SplitItem}"/>
                                                        
                                                
                                                
                                            </td>               
                                    </tr>
            
                                </apex:repeat>
                            </table>
                        </td>
                        <td width="80%">
                            <apex:tabPanel switchType="client" selectedTab="name1" id="theTabPanel" style="padding:0px;margin:0px;border:0px;" inactiveTabClass="inactiveTab" immediate="false" tabClass="cursor:hand" value="{!ActiveTab}">
                                <!-- Period Tab -->
                                <apex:tab label="{!$Label.Tab1}" name="name1" id="tabOne" style="padding:0px;margin:0px;border:0px;background-color:#F3F3DC;">
                                    <div style="overflow-x: auto;overflow-y:auto;border:0px;padding:0px;margin:0px;" id="mydev1">
                                        <table cellpadding="0" cellspacing="0" width="100%">
                                            <tr id="tab1" style="height:64px;border-bottom:1px solid #E3DEB8;background-color:#F3F3EC">
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.Description.label}" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.from_Date__c.label}" style="color: #CC0000;" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.until_Date__c.label}" style="color: #CC0000;" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="Length (months)" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="Extra (days)" />
                                                </td>
                                                <td class="colContent">&nbsp;</td>
                                            </tr>
                                            <apex:repeat value="{!lDisplayRec}" var="rec" id="myRepeat1">
                                                <tr style="height:106px">
                                                    <td align="center" class="colContent" style="padding-left: 5px;">
                                                        <div>
                                                            <apex:inputTextArea cols="40" rows="2" value="{!rec.item.Description}" id="LineDescription" />
                                                        </div>
                                                        <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','LineDescription','1');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Description')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                        <apex:commandLink onclick="forceCopyField('{!rec.position}','LineDescription','1');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Description')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                    </td>
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="125px">
                                                        <div class="requiredExample" style="text-align:left;"><span style="width:2px;"></span> 
                                                            <apex:inputField value="{!rec.item.from_Date__c}" id="startDate" required="false" style="padding-left: 2px;width:125px;" />
                                                            <!-- onChange="change_fromdate('{!rec.position}');" -->
                                                        </div>
                                                        <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','startDate','1');return false;" onmouseover="setPosition('{!rec.position}');setColumn('from_Date__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                        <apex:commandLink onclick="forceCopyField('{!rec.position}','startDate','1');return false;" onmouseover="setPosition('{!rec.position}');setColumn('from_Date__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                    </td>
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="125px">
                                                        <div class="requiredExample" style="text-align:left;"><span style="width:2px;"></span>

                                                            <apex:inputField value="{!rec.item.until_Date__c}" id="endDate" required="false" style="padding-left: 2px;width:125px;" onClick="setToDate('{!rec.position}')" />
                                                        </div>
                                                        <script>
                                                            disableInputField('{!rec.position}', '{!rec.pro.ManualSetEndDate__c}', 'endDate', 'myRepeat1');
                                                        </script>
                                                        <div style="{!If(rec.pro.ManualSetEndDate__c == true, '', 'display:none;')}">
                                                            <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','endDate','1');return false;" onmouseover="setPosition('{!rec.position}');setColumn('until_Date__c')" style="margin-top:2px">
                                                                <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                            <apex:commandLink onclick="forceCopyField('{!rec.position}','endDate','1');return false;" onmouseover="setPosition('{!rec.position}');setColumn('until_Date__c')" style="margin-top:2px">
                                                                <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                        </div>
                                                    </td>
                                                    <td align="center" style="padding-left: 5px; width:100px;" class="colContent">
                                                        <div>
                                                            <apex:inputField value="{!rec.item.Length_Months__c}" id="Length" style="width:100px"/>
                                                        </div>
                                                        <script>
                                                            disableInputField('{!rec.position}', '{!rec.pro.MonthsDays__c}', 'Length', 'myRepeat1');
                                                        </script>
                                                        <div style="{!If(rec.pro.MonthsDays__c == true, '', 'display:none;')}">
                                                            <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','Length','1');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Length_Months__c')" style="margin-top:2px;">
                                                                <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                            <apex:commandLink onclick="forceCopyField('{!rec.position}','Length','1');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Length_Months__c')" style="margin-top:2px;">
                                                                <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                        </div>
                                                    </td>
                                                    <td align="center" style="padding-left: 5px;width:100px;" class="colContent">
                                                        <div>
                                                            <apex:inputField value="{!rec.item.Additional_Time_Days__c}" id="Extra" style="width:100px" />
                                                        </div>
                                                        <script>
                                                            disableInputField('{!rec.position}', '{!rec.pro.MonthsDays__c}', 'Extra', 'myRepeat1');
                                                        </script>
                                                        <div style="{!If(rec.pro.MonthsDays__c == true, '', 'display:none;')}">
                                                            <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','Extra','1');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Additional_Time_Days__c')" style="margin-top:2px;">
                                                                <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                            <apex:commandLink onclick="forceCopyField('{!rec.position}','Extra','1');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Additional_Time_Days__c')" style="margin-top:2px;">
                                                                <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                        </div>
                                                    </td>
                                                    <td class="colContent">&nbsp;</td>
                                                </tr>
                                            </apex:repeat>
                                        </table>
                                    </div>
                                    <script>
                                        // setWidthDiv('mydev1');
                                    </script>
                                </apex:tab>
                                <!-- End Period Tab -->
                                <!-- Pricing Tab -->
                                <apex:tab label="{!$Label.Tab2}" name="name2" id="tabTwo" style="padding:0px;margin:0px;border:0px;background-color:#F3F3DC;">
                                    <div style="overflow-x: auto;overflow-y:hidden;border:0px;padding:0px;margin:0px;" id="mydevPrice">
                                        <!-- HCS 29.04.2014 fixed change width from 1000px to 100% , because it not show scroll bar -->
                                        <table cellpadding="0" cellspacing="0" width="100%">
                                            <tr id="tab2" style="height:64px;border-bottom:1px solid #E3DEB8;background-color:#F3F3EC">
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.Billing_Category__c.label}" style="color: #CC0000;" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.Quantity.label}" style="color: #CC0000;" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.UnitPrice.label}" style="color: #CC0000;" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="Surcharge" />
                                                    <br/>
                                                    <apex:outputText value="(%)" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="Discount" />
                                                    <br/>
                                                    <apex:outputText value="(%)" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="Sales Price" />
                                                    <br/>
                                                    <apex:outputText value="Target" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.AE__c.label}" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="Net/Net/Net" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="Budget" />
                                                    <br/>
                                                    <apex:outputText value="Net/Net/Net" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="Discount reason" />
                                                </td>
                                                <td class="colHeader">&nbsp;</td>
                                            </tr>
                                            <apex:repeat value="{!lDisplayRec}" var="rec" id="myRepeat2">
                                                <tr style="height:106px;background-color:#F3F3DC" class="multiSelectPicklistRow">
                                                
                                                    <!-- Billing Category -->
                                                    <td align="center" class="colContent" style="padding-left: 10px;">
                                                        <!-- apex:outputText rendered="{!if(rec.item.PricebookEntry.Product2.Variable_CPM_price__c || Not(isEdit),true,false)}" -->
                                                        <apex:outputText >
                                                            <!-- rendered="{!rec.item.PricebookEntry.Product2.Variable_CPM_price__c}" -->
                                                            <table cellpadding="0" cellspacing="0" width="100%" border="0">
                                                                <tr>
                                                                    <td>
                                                                        <div class="requiredExample" style="text-align:left;"><span style="width:2px;"></span> 
                                                                            <!-- apex:inputField id="BillingCategory" value="{!rec.item.Billing_category__c}" rendered="{!if(rec.item.PricebookEntry.Product2.Variable_CPM_price__c || Not(isEdit),true,false)}" onChange="changeBC('{!rec.position}','{!rec.item.PricebookEntry.Product2.Fixed_price__c}')"
                                                                            required="false"/ -->
                                                                            <!-- <apex:inputField id="BillingCategory" value="{!rec.item.Billing_category__c}" onChange="changeBC('{!rec.position}','{!rec.item.PricebookEntry.Product2.Fixed_price__c}')" required="false" style="width:100%"/>-->
                                                                            <apex:selectList id="BillingCategory" styleClass="{!If(rec.errBillin == '', '',If(isSave == true,'error',''))}" value="{!rec.billingCategory2}" multiselect="false" Size="1" onChange="changeBC('{!rec.position}','{!rec.item.PricebookEntry.Product2.Fixed_price__c}')"
                                                                            required="false" style="width:70px">
                                                                                <apex:selectOptions value="{!rec.listBilling}"></apex:selectOptions>
                                                                            </apex:selectList>
                                                                            <div class="errorMsg" style="{!If(rec.errBillin == '', 'display:none;',If(isSave == true,'','display:none'))}"><strong>Error:</strong> {!rec.errBillin}</div>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="center">
                                                                        <!-- apex:commandLink action="{!copyField}" rerender="MyPageBlock" status="status" style="margin-top:2px" rendered="{!if(rec.item.PricebookEntry.Product2.Variable_CPM_price__c || Not(isEdit),true,false)}" -->
                                                                        <apex:commandLink action="{!copyField}" rerender="MyPageBlock" status="status" style="margin-top:2px">
                                                                            <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" />
                                                                            <apex:param name="selPosition" value="{!rec.position}" assignTo="{!selPosition}" />
                                                                            <apex:param name="selColumn" value="Billing_category__c" assignTo="{!selColumn}" />
                                                                        </apex:commandLink> 
                                                                        
                                                                        <span></span>

                                                                        <apex:commandLink action="{!forceCopyField}" rerender="MyPageBlock" status="status" style="margin-top:2px">
                                                                            <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" />
                                                                            <apex:param name="selPosition" value="{!rec.position}" assignTo="{!selPosition}" />
                                                                            <apex:param name="selColumn" value="Billing_category__c" assignTo="{!selColumn}" />
                                                                        </apex:commandLink>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </apex:outputText>
                                                        <!-- apex:outputText rendered="{!if(Not(rec.item.PricebookEntry.Product2.Variable_CPM_price__c) && isEdit,true,false)}" -->
                                                        <!-- <apex:outputText rendered="{!!rec.item.PricebookEntry.Product2.Variable_CPM_price__c}">
                                                                                            <div class="visibleDiv" ><apex:outputtext value="{!rec.item.Billing_category__c}"  /></div>
                                                                                             <apex:image value="{!$Resource.Copy}" />
                                                                                             
                                                                           </apex:outputText> 
                                                                       -->
                                                    </td>
                                                    <!-- QTY -->
                                                    <td align="center" style="padding-left: 10px;" class="colContent">
                                                        <table cellpadding="0" cellspacing="0" width="100%" border="0">
                                                            <tr>
                                                                <td>
                                                                    <div class="requiredExample" style="text-align:left;"><span style="width:2px;"></span> 
                                                                        <apex:inputText disabled="{!rec.QuantityReadonly}" styleClass="{!If(rec.errQty == '', '',If(isSave == true,'error',''))}" value="{!rec.quantity}" required="false" id="Quantity" style="padding-left: 2px;width:70px;"></apex:inputText>
                                                                        <div class="errorMsg" style="{!If(rec.errQty == '', 'display:none;',If(isSave == true,'','display:none'))}"><strong>Error:</strong> {!rec.errQty}</div>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td align="center">
                                                                    <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','Quantity','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Quantity')" style="margin-top:2px">
                                                                        <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                                    <apex:commandLink onclick="forceCopyField('{!rec.position}','Quantity','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Quantity')" style="margin-top:2px">
                                                                        <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                    <!-- sale price (unitPrice) -->
                                                    <td align="center" style="padding-left: 10px;" class="colContent">
                                                        <!-- For the billing category â€œCPMâ€� the sales price should not be editable. For all other billing categories the sales price is editable if at the product fix_price__c=t rue than the sales price within the visualforce page should not be editable, but
                                                        in case that the user choose the billing category "CPC" or "CPO" at the visualforce page, than the price should be editable -->
                                                        <apex:outputText >
                                                            <table cellpadding="0" cellspacing="0" width="100%" border="0">
                                                                <tr>
                                                                    <td>
                                                                        <div class="requiredExample" style="text-align:left;"><span style="width:2px;"></span>

                                                                            <apex:inputText styleClass="{!If(rec.errSalePrice == '', '',If(isSave == true,'error',''))}" value="{!rec.item.UnitPrice}" id="Sales_Price" style="width:70px;" />
                                                                            <div class="errorMsg" style="{!If(rec.errSalePrice == '' , 'display:none;', If(isSave == true,'','display:none'))}"><strong>Error:</strong> {!rec.errSalePrice}</div>
                                                                            <script>
                                                                                var sp = document.getElementById('{!$Component.Sales_Price}');
                                                                                if ('{!rec.item.PricebookEntry.Product2.Fixed_price__c}' == 'true') {
                                                                                    sp.disabled = true;
                                                                                }
                                                                            </script>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="center">
                                                                        <div style="{!If(rec.pro.Fixed_price__c == false, '', 'display:none;')}">
                                                                            <apex:commandLink onclick="checkValidationCopyField2('{!rec.position}','Sales_Price','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('UnitPrice')">
                                                                                <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span> 
                                                                            <apex:commandLink onclick="forceCopyField2('{!rec.position}','Sales_Price','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('UnitPrice')">
                                                                                <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                                        </div>
                                                                        <div style="{!If(rec.pro.Fixed_price__c == true, '', 'display:none;')}">&nbsp;</div>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </apex:outputText>
                                                    </td>
                                                    <!-- Surcharge -->
                                                    <td align="center" class="colContent" style="padding-left: 5px; ">
                                                        <table cellpadding="0" cellspacing="0" width="100%" border="0">
                                                            <tr>
                                                                <td>
                                                                    <!-- Type surcharge -->
                                                                    
                                                                    <apex:outputPanel id="panelSurcharge">
                                                                        <apex:inputHidden value="{!rec.item.Targeting_Surcharge__c}" id="Surcharge" /></apex:outputPanel>
                                                                    <apex:outputPanel id="panelSurchargeSpinner">
                                                                        <input id="spinner{!rec.position}" style="width:40px" value="{!rec.item.Targeting_Surcharge__c}" />
                                                                        <script>
                                                                            jq("#spinner{!rec.position}").spinner({
                                                                                    max: 100,
                                                                                    min: 0,
                                                                                    change: function (event, ui) {
                                                                                        var elem_surcharge = document.getElementById('myPage:myForm:MyPageBlock:myRepeat2:{!rec.position}:Surcharge');
                                                                                        elem_surcharge.value = this.value;
                                                                                    }
                                                                                });

                                                                            
                                                                        </script>
                                                                    </apex:outputPanel>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td align="center">
                                                                    <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','Surcharge','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Targeting_Surcharge__c')" style="margin-top:2px">
                                                                        <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                                    <apex:commandLink onclick="forceCopyField('{!rec.position}','Surcharge','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Targeting_Surcharge__c')" style="margin-top:2px">
                                                                        <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                    <!-- Discount -->
                                                    <td align="center" class="colContent" style="padding-left: 5px; ">
                                                        <!-- Type discount -->
                                                        <apex:outputPanel id="panelDiscount">
                                                            <apex:inputHidden value="{!rec.item.Rate_Discount_II__c}" id="Discount" />
                                                                <!-- <apex:actionSupport event="onchange" action="{!calculateDiscountPrice}" rerender="DiscountPrice">
                                                                                <apex:param name="selectedRandomNr" value="{!rec.randomNr}" assignTo="{!selectedRandomNr}"/>
                                                                            </apex:actionSupport>-->
                                                        </apex:outputPanel>
                                                        <apex:outputPanel id="panelDiscountSpinner">
                                                            <input id="spinnerDiscount{!rec.position}" style="width:40px" value="{!rec.item.Rate_Discount_II__c}" />
                                                            <script>
                                                                jq("#spinnerDiscount{!rec.position}").spinner({
                                                                        max: 100,
                                                                        min: 0,
                                                                        change: function (event, ui) {
                                                                            var elem_discount = document.getElementById('myPage:myForm:MyPageBlock:myRepeat2:{!rec.position}:Discount');
                                                                            elem_discount.value = this.value;
                                                                        }
                                                                    });

                                                                
                                                            </script>
                                                        </apex:outputPanel>
                                                        <br/>
                                                        <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','Discount','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Rate_Discount_II__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                        <apex:commandLink onclick="forceCopyField('{!rec.position}','Discount','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Rate_Discount_II__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                    </td>
                                                    <!-- Sales Price Target -->
                                                    <td align="center" class="colContent" style="padding-left: 5px; ">
                                                        <apex:inputField value="{!rec.item.Sales_Price_Target__c}" id="Target" style="width:70px;"></apex:inputField>
                                                        <br/>
                                                        <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','Target','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Sales_Price_Target__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                        <apex:commandLink onclick="forceCopyField('{!rec.position}','Target','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Sales_Price_Target__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                    </td>
                                                    <!-- Agency Commission -->
                                                    <td align="center" style="padding-left: 5px;" class="colContent">
                                                        <apex:inputField value="{!rec.item.AE__c}" id="AE" style="width:35px;"></apex:inputField>
                                                        <br/>
                                                        <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','AE','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('AE__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                        <apex:commandLink onclick="forceCopyField('{!rec.position}','AE','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('AE__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                    </td>
                                                    <!-- Net/Net/Net -->
                                                    <td align="center" class="colContent" style="padding-left: 5px; ">
                                                        <table cellpadding="0" cellspacing="0" width="100%" border="0">
                                                            <tr>
                                                                <td>
                                                                    <div style="text-align:left;"><span style="width:2px;"></span>

                                                                        <apex:inputText value="{!rec.item.Net_Net_Net__c}" id="NNN" style="width:75px;" />
                                                                        <script>
                                                                            var index = checkCurrentPosition('{!rec.position}');
                                                                            var sp = document.getElementById('myPage:myForm:MyPageBlock:myRepeat2:' + index + ':NNN');
                                                                            if ('{!rec.item.PricebookEntry.Product2.Fixed_price__c}' == 'true') {
                                                                                sp.disabled = true;
                                                                            }
                                                                        </script>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td align="center">&nbsp;</td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                    <!-- Net/Net/Net Target -->
                                                    <td align="center" class="colContent" style="padding-left: 5px; ">
                                                        <apex:inputField value="{!rec.item.Budget_NetNetNet__c}" id="NNNTarget" style="width:75px;"></apex:inputField>
                                                        <br/>
                                                        <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','NNNTarget','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Budget_NetNetNet__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                        <apex:commandLink onclick="forceCopyField('{!rec.position}','NNNTarget','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Budget_NetNetNet__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                    </td>
                                                    <!-- Discount Reason -->
                                                    <td align="center" style="padding-left: 5px;" class="colContent">
                                                        <apex:inputField value="{!rec.item.Rebate_In_Kind_Reason__c}" id="GD1" style="" />
                                                        <br/>
                                                        <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','GD1','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Rebate_In_Kind_Reason__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                        <apex:commandLink onclick="forceCopyField('{!rec.position}','GD1','2');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Rebate_In_Kind_Reason__c')" style="margin-top:2px">
                                                            <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                    </td>
                                                    <td class="colContent">&nbsp;</td>
                                                </tr>
                                            </apex:repeat>
                                        </table>
                                    </div>
                                    <script>
                                        // setWidthDiv('mydev1');
                                    </script>
                                </apex:tab>
                                <!-- End Pricing Tab -->
                                
                                 <apex:tab label="{!$Label.Tab6}" name="tabname6" id="tabname6" style="padding:0px;margin:0px;border:0px;background-color:#F3F3DC; display:none">
                                    <div style="padding:0px;margin:0px;border:0px solid;overflow-x: auto;overflow-y:hidden;" id="mydev6">
                                        <table cellpadding="0" cellspacing="0" width="100%">
                                            <tr id="tab1" style="height:64px;border-bottom:1px solid #E3DEB8;background-color:#F3F3EC">
                                                <td align="center" class="colHeader" width="60px">&nbsp;</td>
                                                <td align="center" class="colHeader" width="427px">
                                                    <apex:outputText value="Category Targeting" />
                                                </td>
                                                <!-- value=" {!$ObjectType.OpportunityLineItem.Fields.Rich_Line_Description__c.label}" -->
                                                <td align="center" class="colHeader" width="427px">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.KeyValueString__c.label}" />
                                                </td>
                                                <td class="colHeader" width="127px">&nbsp;</td>
                                            </tr>
                                            <!-- <apex:repeat value="{!lstRecords}" var="rec" id="myRepeat6"> -->
                                           
                                            <apex:repeat value="{!lDisplayRec}" var="rec" id="myRepeat6">
                                                <tr style="height:106px">
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="60px">
                                                        <apex:inputHidden value="{!rec.item.Targeting__c}" id="hidTargetId" />
                                                        <apex:inputHidden value="{!rec.proId}" id="hidProId" />
                                                        <apex:inputHidden value="{!rec.availableSite}" id="hidAvail" />
                                                        <apex:inputHidden value="{!rec.availableKV}" id="hidAvaiKV" />
                                                    </td>
                                                    <td width="40px">
                                                                         <!-- HCS 09.05.2014 -->
                                                                        <apex:commandButton rendered="{!rec.isHasPreDefine}" id="btnNewKeyValue" value="New Key Value" onclick="openKeyValueconfiguration('{!rec.proId}','{!rec.item.id}',{!rec.position}); return false;" />
                                                                        
                                                                    </td>
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="427px">
                                                        <table cellspacing="0" cellpadding="0">
                                                            <tr>
                                                                <td>
                                                                    <!-- <apex:commandButton id="btnTarget" value="Select" onclick="openTargetingTreePopup(this.id,'myPage:myForm:MyPageBlock:myRepeat6:{!rec.position}:hidTargetId','TargetingButton'); return false;"/>-->
                                                                    <apex:commandButton rendered="{!IF(rec.isFixedSite==true, false, IF(rec.isHasSite == true, true, false))}" id="btnTarget" value="Select" onclick="getTargetingTreePopup(this.id,{!rec.position},'TargetingButton'); return false;" />
                                                                    <apex:inputHidden value="{!rec.item.Rich_Line_Description__c}" id="txaTarget_hid" />
                                                                </td>
                                                                <td>
                                                                    <table cellspacing="0" cellpadding="0">
                                                                        <tr>
                                                                            <td>
                                                                                <apex:inputTextArea disabled="{!IF(rec.isFixedSite == true, true, IF(rec.isHasSite == true, true, true))}" id="txaTarget" value="{!rec.item.Rich_Line_Description__c}" cols="48" rows="4" style="vertical-align:middle;" />
                                                                                <script>
                                                                                    putAvailableSiteToFixedSite('{!rec.position}', '{!rec.isFixedSite}');
                                                                                </script>
                                                                            </td>

                                                                            <td>
                                                                                <div style="{!IF(rec.isFixedSite==true, 'display:none;', IF(rec.isHasSite == true, '', 'display:none;'))}">
                                                                                    <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','txaTarget','6');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Rich_Line_Description__c')" style="margin-top:2px;padding-left:5px">
                                                                                        <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span> 
                                                                                    <apex:commandLink onclick="forceCopyField('{!rec.position}','txaTarget','6');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Rich_Line_Description__c')" style="margin-top:2px;padding-left:5px">
                                                                                        <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="427px">
                                                        <table cellspacing="0" cellpadding="0">
                                                            <tr>
                                                                <td width="40px">
                                                                    <!-- <apex:commandButton id="btnKeyValue" value="Key Value" onclick="openTargetingTreePopup(this.id,'myPage:myForm:MyPageBlock:myRepeat6:{!rec.position}:hidTargetId','KeyValueButton'); return false;"/>-->
                                                                    <apex:commandButton rendered="{!rec.isHasPreDefine}" id="btnKeyValue" value="Select" onclick="getTargetingTreePopup(this.id,{!rec.position},'KeyValueButton'); return false;" />
                                                                </td>
                                                                <td>
                                                                    <apex:inputTextArea disabled="{!IF(rec.isHasPreDefine== true, false, true)}" id="keyvalueString" value="{!rec.item.KeyValueString__c}" cols="48" rows="4" style="vertical-align:middle;" onchange="mergeKVKW('{!rec.position}')" />
                                                                </td>
                                                                <td style="{!IF(rec.isHasPreDefine== true, '', 'display:none;')}" width="20px">
                                                                    <table style="display:none;">
                                                                        <tr>
                                                                            <td>
                                                                                <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','keyvalueString','6');return false;" onmouseover="setPosition('{!rec.position}');setColumn('KeyValueString__c')" style="margin-top:2px;padding-left:5px">
                                                                                    <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink>
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>
                                                                                <apex:commandLink onclick="forceCopyField('{!rec.position}','keyvalueString','6');return false;" onmouseover="setPosition('{!rec.position}');setColumn('KeyValueString__c')" style="margin-top:2px;padding-left:5px">
                                                                                    <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </apex:repeat>
                                        </table>
                                    </div>
                                    <script>
                                        $$('table.multiSelectPicklistTable tr.multiSelectPicklistRow select').each(function (i) {
                                                i.style.height = "55px";
                                                i.style.width = "130px";
                                            });
                                         //setWidthDiv('mydev2');
                                    </script>
                                </apex:tab>
                                <!-- Regional Targeting -->
                                <apex:tab label="{!$Label.Tab7}" name="tabname7" id="tabname7" style="padding:0px;margin:0px;border:0px;background-color:#F3F3DC; display:none">
                                    <div style="padding:0px;margin:0px;border:0px solid;overflow-x: auto;overflow-y:hidden;" id="mydev7">
                                        <table cellpadding="0" cellspacing="0" width="100%">
                                            <tr id="tab7" style="height:64px;border-bottom:1px solid #E3DEB8;background-color:#F3F3EC">
                                                <td align="center" class="colHeader" width="60px">&nbsp;</td>
                                                <td align="center" class="colHeader" width="427px">Countries</td>
                                                <td align="center" class="colHeader" width="427px">Cities</td>
                                                <td align="center" class="colHeader" width="127px">&nbsp;</td>
                                                <!-- <td class="colHeader">&nbsp;</td> -->
                                            </tr>
                                            <!-- <apex:repeat value="{!lstRecords}" var="rec" id="myRepeat7">-->
                                            <apex:repeat value="{!lDisplayRec}" var="rec" id="myRepeat7">
                                                <tr style="height:106px">
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="60px"></td>
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="427px">
                                                        <table cellspacing="0" cellpadding="0">
                                                            <tr>
                                                                <td>
                                                                    <apex:commandButton rendered="{!IF(rec.pro.Geo_IP__c==true, true, false)}" id="btnCountry" value="Select" onclick="getTargetingTreePopup(this.id,{!rec.position},'CountriesButton'); return false;" />
                                                                </td>
                                                                <td>
                                                                    <table cellspacing="0" cellpadding="0">
                                                                        <tr>
                                                                            <td>
                                                                                <apex:inputTextArea id="txaCountry" value="{!rec.item.Countries_Description__c}" cols="48" rows="4" style="vertical-align:middle;" />
                                                                                <script>
                                                                                    disableInputField('{!rec.position}', '{!rec.pro.Geo_IP__c}', 'txaCountry', 'myRepeat7');
                                                                                </script>
                                                                            </td>
                                                                            <td>
                                                                                <div style="{!If(rec.pro.Geo_IP__c == true, '', 'display:none;')}">
                                                                                    <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','txaCountry','7');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Countries_Description__c')" style="margin-top:2px;padding-left:5px">
                                                                                        <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span> 
                                                                                    <apex:commandLink onclick="forceCopyField('{!rec.position}','txaCountry','7');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Countries_Description__c')" style="margin-top:2px;padding-left:5px">
                                                                                        <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="427px">
                                                        <table cellspacing="0" cellpadding="0">
                                                            <tr>
                                                                <td>
                                                                    <apex:commandButton rendered="{!IF(rec.pro.Geo_IP__c==true, true, false)}" id="btnCities" value="Select" onclick="getTargetingTreePopup(this.id,{!rec.position},'CitiesButton'); return false;" />
                                                                </td>
                                                                <td>
                                                                    <table cellspacing="0" cellpadding="0">
                                                                        <tr>
                                                                            <td>
                                                                                <apex:inputTextArea id="txaCities" value="{!rec.item.City_description__c}" cols="48" rows="4" style="vertical-align:middle;" />
                                                                                <script>
                                                                                    disableInputField('{!rec.position}', '{!rec.pro.Geo_IP__c}', 'txaCities', 'myRepeat7');
                                                                                </script>
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                                <td>
                                                                    <div style="{!If(rec.pro.Geo_IP__c == true, '', 'display:none;')}">
                                                                        <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','txaCities','7');return false;" onmouseover="setPosition('{!rec.position}');setColumn('City_description__c')" style="margin-top:2px;padding-left:5px">
                                                                            <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" />
                                                                        </apex:commandLink> <span></span>

                                                                        <apex:commandLink onclick="forceCopyField('{!rec.position}','txaCities','7');return false;" onmouseover="setPosition('{!rec.position}');setColumn('City_description__c')" style="margin-top:2px;padding-left:5px">
                                                                            <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" />
                                                                        </apex:commandLink>
                                                                    </div>
                                                                </td>
                                                                
                                                            </tr>
                                                         </table>
                                                    </td>
                                                    <td class="colContent">&nbsp;</td>
                                                </tr>
                                            </apex:repeat>
                                        </table>
                                    </div>
                                <script>
                                    $$('table.multiSelectPicklistTable tr.multiSelectPicklistRow select').each(function (i) {
                                            i.style.height = "55px";
                                            i.style.width = "130px";
                                        });
                                     //setWidthDiv('mydev2');
                                </script>
                        </apex:tab>
                                
                                <!-- New Request -->
                               <!-- HCS 11.04.2014  add new tab targeting-->
                              <apex:tab label="Targeting" name="tabname10" id="tabname10" style="padding:0px;margin:0px;border:0px;background-color:#F3F3DC">
                                    <div style="padding:0px;margin:0px;border:0px solid;overflow-x: auto;overflow-y:hidden;" id="mydev10">
                                <table cellpadding="0" cellspacing="0" width="100%">
                                    <tr id="tab10" style="height:64px;border-bottom:1px solid #E3DEB8;background-color:#F3F3EC">
                                        

                                        <td align="center" class="colHeader">DFP Category, KeyValue, Browser, Connection, Device, Geography IP Targeting</td>
                                        <td align="center" class="colHeader">&nbsp;</td>  
                                    </tr>
                                    <apex:repeat value="{!lDisplayRec}" var="rec" id="myRepeat10">
                                        <tr style="height:106px">
<!--                                            <td align="center" class="colHeader">&nbsp;</td>        -->
                                            <td align="center" class="colContent" style="padding-left: 5px;" >
                                                 <table cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td>
                                                           <div > 
                                                           
                                                            <apex:commandButton value="Select" onclick="opeNewTargetingPopup('{!rec.proId}','{!rec.item.id}',{!rec.position});return false;" id="newTargeting"  style="width: 120px;"/>
                                                          </div>
                                                         </td>
                                                         <td style="padding-left: 5px;">
                                                             <apex:commandLink onclick="doCopyForNewTargeting();return false;" onmouseover="setPosition('{!rec.position}');" style="margin-top:2px">
                                                                <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" />
                                                            </apex:commandLink>
                                                            <span></span>
                                                            <apex:commandLink onclick="doForceCopyForNewTargeting();return false;" onmouseover="setPosition('{!rec.position}');" style="margin-top:2px">
                                                                <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" />
                                                            </apex:commandLink>
                                                         </td>
                                                    </tr>
                                                  </table>                                               
                                            </td>
                                            <td align="center" class="colContent" style="padding-left: 5px;">&nbsp;</td>
                                        </tr>
                                    </apex:repeat>
                                </table>
                                    </div>
                              </apex:tab>
                                <!-- Frequency Capping Tab -->
                                <apex:tab label="{!$Label.Tab3}" name="name3" id="tabThree" style="padding:0px;margin:0px;border:0px;background-color:#F3F3DC">
                                    <div style="padding:0px;margin:0px;border:0px solid;overflow-x: auto;overflow-y:hidden;" id="mydev3">
                                        <table cellpadding="0" cellspacing="0" width="100%">
                                            <tr id="tab3" style="height:64px;border-bottom:1px solid #E3DEB8;background-color:#F3F3EC">
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.Check_Inventory__c.label}" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.FC_Quantity__c.label}" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.FC_Ad_served_every__c.label}" />
                                                </td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.FC_Period__c.label}" />
                                                </td>
                                                <td class="colContent">&nbsp;</td>
                                                <td align="center" class="colHeader">
                                                    <apex:outputText value="{!$ObjectType.OpportunityLineItem.Fields.AdKeywords__c.label}" />
                                                </td>
                                             
                                            </tr>
                                            <!-- <apex:repeat value="{!lstRecords}" var="rec" id="myRepeat3"> -->
                                            <apex:repeat value="{!lDisplayRec}" var="rec" id="myRepeat3">
                                                <tr style="height:106px;background-color:#F3F3DC" class="multiSelectPicklistRow">
                                                    <td align="center" class="colContent" style="padding-left: 2px;" width="80px">
                                                        <apex:inputField value="{!rec.item.Check_Inventory__c}" id="Check_inventory" />
                                                        <script>
                                                            disableInputField('{!rec.position}', '{!rec.pro.FC__c}', 'Check_inventory', 'myRepeat3');
                                                        </script>
                                                        <div style="{!If(rec.pro.FC__c == true, '', 'display:none;')}">
                                                            <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','Check_inventory','3');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Check_Inventory__c')" style="margin-top:2px;">
                                                                <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                            <apex:commandLink onclick="forceCopyField('{!rec.position}','Check_inventory','3');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Check_Inventory__c')" style="margin-top:2px;">
                                                                <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                        </div>
                                                    </td>
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="150px">
                                                        <apex:inputField value="{!rec.item.FC_Quantity__c}" id="FC_Quantiy" />
                                                        <script>
                                                            disableInputField('{!rec.position}', '{!rec.pro.FC__c}', 'FC_Quantiy', 'myRepeat3');
                                                        </script>
                                                        <div style="{!If(rec.pro.FC__c == true, '', 'display:none;')}">
                                                            <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','FC_Quantiy','3');return false;" onmouseover="setPosition('{!rec.position}');setColumn('FC_Quantity__c')" style="margin-top:2px;text-align:center;">
                                                                <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                            <apex:commandLink onclick="forceCopyField('{!rec.position}','FC_Quantiy','3');return false;" onmouseover="setPosition('{!rec.position}');setColumn('FC_Quantity__c')" style="margin-top:2px;text-align:center;">
                                                                <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                        </div>
                                                    </td>
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="150px">
                                                        <apex:inputField value="{!rec.item.FC_Ad_served_every__c}" id="Fc_Ad_served" />
                                                        <script>
                                                            disableInputField('{!rec.position}', '{!rec.pro.FC__c}', 'Fc_Ad_served', 'myRepeat3');
                                                        </script>
                                                        <div style="{!If(rec.pro.FC__c == true, '', 'display:none;')}">
                                                            <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','Fc_Ad_served','3');return false;" onmouseover="setPosition('{!rec.position}');setColumn('FC_Ad_Served_every__c')" style="margin-top:2px;text-align:center;">
                                                                <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                            <apex:commandLink onclick="forceCopyField('{!rec.position}','Fc_Ad_served','3');return false;" onmouseover="setPosition('{!rec.position}');setColumn('FC_Ad_Served_every__c')" style="margin-top:2px;text-align:center;">
                                                                <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                        </div>
                                                    </td>
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="80px">
                                                        <apex:inputField value="{!rec.item.FC_Period__c}" id="FC_Period" />
                                                        <script>
                                                            disableInputField('{!rec.position}', '{!rec.pro.FC__c}', 'FC_Period', 'myRepeat3');
                                                        </script>
                                                        <div style="{!If(rec.pro.FC__c == true, '', 'display:none;')}">
                                                            <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','FC_Period','3');return false;" onmouseover="setPosition('{!rec.position}');setColumn('FC_Period__c')" style="margin-top:2px">
                                                                <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                            <apex:commandLink onclick="forceCopyField('{!rec.position}','FC_Period','3');return false;" onmouseover="setPosition('{!rec.position}');setColumn('FC_Period__c')" style="margin-top:2px">
                                                                <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                        </div>
                                                    </td>
                                                    <td class="colContent">&nbsp;</td>
                                                    <td align="center" class="colContent" style="padding-left: 5px;" width="127px">
                                                        <apex:inputTextArea disabled="{!IF(rec.pro.Keywords__c == false, true, false)}" id="keyword" value="{!rec.keyWords}" cols="48" rows="3" style="vertical-align:middle;" onChange="mergeKVKW('{!rec.position}')" />
                                                        <div style="{!IF(rec.pro.Keywords__c == false, 'display:none;', '')}">
                                                            <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','keyword','3');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Keywords__c')" style="margin-top:2px">
                                                                <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>

                                                            <apex:commandLink onclick="forceCopyField('{!rec.position}','keyword','3');return false;" onmouseover="setPosition('{!rec.position}');setColumn('Keywords__c')" style="margin-top:2px">
                                                                <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                        </div>
                                                    </td>
                                             
                                                </tr>
                                            </apex:repeat>
                                        </table>
                                    </div>
                                    <script>
                                        $$('table.multiSelectPicklistTable tr.multiSelectPicklistRow select').each(function (i) {
                                                i.style.height = "55px";
                                                i.style.width = "130px";
                                            });
                                         // setWidthDiv('mydev3');
                                    </script>
                                </apex:tab>
                               <!-- Time-Targeting Tab --> 
                                     <apex:tab label="{!$Label.Tab4}" name="name4" id="tabFour" style="padding:0px;margin:0px;border:0px;background-color:#F3F3DC">
                                          
                                         <div style="padding:0px;margin:0px;border:0px solid;overflow-x: auto;overflow-y:hidden;" id="mydev4">
                                             <table cellpadding="0" cellspacing="0" width="100%" >
                                                        

                            <tr id ="tab4" style="height:64px;border-bottom:1px solid #E3DEB8;background-color:#F3F3EC">                                            
                                                           <td class="colHeader"> </td>       
                                                        </tr>
                                                        
                                                        <!-- <apex:repeat value="{!lstRecords}" var="rec"  id="myRepeat4"> -->
                                                        <apex:repeat value="{!lDisplayRec}" var="rec"  id="myRepeat4">
                                                           
                                                            <tr style="height:106px;background-color:#F3F3DC" class="multiSelectPicklistRow">  
                                                                
                                                                
                                                                
                                                                <td align="center" class="colContent" style="padding-left: 5px;width: 100%;">
                                                                  <table cellpadding="0" cellspacing="0" id="HourOfDayTable">
                                                                     
                                                                    <tr>  
                                                                      <th width="70" ><a onclick="checkAllHours('{!rec.position}');"            title="{!$Label.TimeTargeting_Tip_RowColumnHeader}"   > Day   </a> </th> 
                                                                      <th width="100"><a onclick="checkEntireHourBlock(0 , '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowHeader}"> 0:00  </a> </th> 
                                                                      <th width="100"><a onclick="checkEntireHourBlock(4 , '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowHeader}"> 4:00  </a> </th> 
                                                                      <th width="100"><a onclick="checkEntireHourBlock(8 , '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowHeader}"> 8:00  </a> </th> 
                                                                      <th width="100"><a onclick="checkEntireHourBlock(12, '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowHeader}"> 12:00 </a> </th> 
                                                                      <th width="100"><a onclick="checkEntireHourBlock(16, '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowHeader}"> 16:00 </a> </th> 
                                                                      <th width="100"><a onclick="checkEntireHourBlock(20, '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowHeader}"> 20:00 </a> </th>
                                                                       
                                                                    </tr>
                                                                     
                                                                     <tr>   
                                                                      <td>
                                                                        <div>
                                                                        <a onclick="checkEntireRow('mon', '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowMondayHeader}"> Monday </a>
                                                                        </div>
                                                                      </td>
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('mon', 0, '{!rec.position}');"> >> </a> </apex:outputPanel>  
                                                                        <apex:outputPanel > <apex:image id="mon0" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon1" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon2" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon3" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('mon', 4, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon4" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon5" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon6" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon7" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('mon', 8, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon8" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon9" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon10" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon11" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('mon', 12, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon12" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon13" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon14" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon15" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div> 
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('mon', 16, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon16" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon17" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon18" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon19" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('mon', 20, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon20" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon21" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon22" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="mon23" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div> 
                                                                      </td>  
                                                                        
                                                                    </tr>
                                                                     
                                                                    <tr>
                                                                      <td>
                                                                        <div>
                                                                        <a onclick="checkEntireRow('tue', '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowTuedayHeader}" > Tuesday </a>
                                                                        </div>
                                                                      </td>
                                                                       
                                         <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('tue', 0, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue0" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue1" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue2" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue3" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div> 
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('tue', 4, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue4" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue5" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue6" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue7" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('tue', 8, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue8" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue9" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue10" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue11" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('tue', 12, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue12" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue13" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue14" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue15" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('tue', 16, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue16" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue17" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue18" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue19" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('tue', 20, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue20" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue21" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue22" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="tue23" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                       
                                                                       
                                                                      
                                                                    </tr>
                                                                     
                                                                    <tr>
                                                                      <td>
                                                                        <div>
                                                                        <a onclick="checkEntireRow('wed', '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowWednesdayHeader}" > Wednesday </a>
                                                                        </div>
                                                                      </td>
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('wed', 0, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed0" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed1" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed2" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed3" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('wed', 4, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed4" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed5" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed6" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed7" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('wed', 8, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed8" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed9" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed10" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed11" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('wed', 12, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed12" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed13" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed14" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed15" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('wed', 16, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed16" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed17" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed18" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed19" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('wed', 20, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed20" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed21" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed22" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="wed23" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                       
                                                                      
                                                                    </tr>
                                                                     
                                                                    <tr>
                                                                      <td>
                                                                        <div>
                                                                        <a onclick="checkEntireRow('thu', '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowThursdayHeader}" > Thursday </a>
                                                                        </div>
                                                                      </td>
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('thu', 0, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu0" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu1" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu2" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu3" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('thu', 4, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu4" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu5" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu6" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu7" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('thu', 8, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu8" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu9" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu10" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu11" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('thu', 12, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu12" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu13" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu14" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu15" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('thu', 16, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu16" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu17" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu18" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu19" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('thu', 20, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu20" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu21" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu22" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="thu23" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td>
                                                                      <td>
                                                                        <div>
                                                                          <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','theHiddenText','4');return false;" onmouseover="setPosition('{!rec.position}');setColumn('DFP_Time_Monday__c')" style="margin-top:2px;">
                                                                                        <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" style="width:13px;hight:14px;"/> 
                                                                                  </apex:commandLink>
                                                                                  
                                                                                  <span></span>
                                                                                  
                                                                                  <apex:commandLink onclick="forceCopyField('{!rec.position}','theHiddenText','4');return false;" onmouseover="setPosition('{!rec.position}');setColumn('DFP_Time_Monday__c')" style="margin-top:2px;">
                                                                                    <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" style="width:13px;hight:14px;"/> 
                                                                                  </apex:commandLink>
                                                                                </div>
                                                                      </td>  
                                                                    </tr>
                                                                     
                                                                    <tr>
                                                                      <td>
                                                                        <div>
                                                                        <a onclick="checkEntireRow('fri', '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowFridayHeader}" > Friday </a>
                                                                        </div>
                                                                      </td>
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('fri', 0, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri0" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri1" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri2" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri3" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('fri', 4, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri4" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri5" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri6" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri7" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                         </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('fri', 8, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri8" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri9" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri10" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri11" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                         </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('fri', 12, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri12" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri13" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri14" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri15" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                         </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('fri', 16, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri16" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri17" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri18" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri19" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                         </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('fri', 20, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri20" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri21" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri22" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="fri23" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                         </div>
                                                                      </td> 
                                                                    </tr>
                                                                     
                                                                    <tr>
                                                                      <td>
                                                                        <div>
                                                                        <a onclick="checkEntireRow('sat', '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowSaturdayHeader}" > Saturday </a>
                                                                        </div>
                                                                      </td>
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sat', 0, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat0" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat1" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat2" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat3" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                         </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sat', 4, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat4" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat5" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat6" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat7" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div> 
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sat', 8, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat8" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat9" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat10" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat11" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                         </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sat', 12, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat12" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat13" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat14" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat15" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div> 
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sat', 16, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat16" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat17" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat18" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat19" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div> 
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sat', 20, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat20" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat21" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat22" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sat23" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div> 
                                                                      </td>
                                                                      <!--  <td colspan="5" style="color:blue;">isOldTimeTargating = {!rec.isOldTimeTargating}</td>  -->
                                                                    </tr>
                                                                     
                                                                    <tr>
                                                                      <td>
                                                                        <div>
                                                                        <a onclick="checkEntireRow('sun', '{!rec.position}');" title="{!$Label.TimeTargeting_Tip_RowSundayHeader}" > Sunday </a>
                                                                        </div>
                                                                      </td>
                                                                      <td>
                                                                        <div> 
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sun', 0, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun0" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun1" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun2" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun3" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div> 
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sun', 4, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun4" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun5" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun6" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun7" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div> 
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sun', 8, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun8" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun9" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/>  </apex:outputPanel> 
                                                                        <apex:outputPanel > <apex:image id="sun10" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun11" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div> 
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sun', 12, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun12" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun13" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun14" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun15" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sun', 16, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun16" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun17" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun18" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun19" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div> 
                                                                      </td> 
                                                                      <td>
                                                                        <div>
                                                                        <apex:outputPanel > <a class="TimeTargetingSelect4Hours" title="{!$Label.TimeTargeting_Tip_4HoursBlock}" onclick="check4Hour('sun', 20, '{!rec.position}');"> >> </a> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun20" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun21" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun22" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        <apex:outputPanel > <apex:image id="sun23" url="{!URLFOR($Resource.CheckBox, '/unchecked.gif')}" onclick="checkHourOfDayOnClick(this, '{!rec.position}')"/> </apex:outputPanel>
                                                                        </div>
                                                                      </td>
                                                                      <td><apex:inputHidden value="{!rec.strHourOfDays}" id="theHiddenText"/></td>  
                                                                    </tr>
                                                                     
                                                                  </table>
                                                                  <script>
                                                                     // Getting String in the input (id="theHiddenText") and checked the checkbox that match with its id. 
                                                                     checkHourOfDayOnload('{!rec.position}', '{!rec.isOldTimeTargating}');
                                                                   </script> 
                                                                </td>
                                                                
<!--                                                                      <td align="center" class="colContent" style="padding-left: 5px;width: 290px;"> -->
                                                                     
<!--                                                                         <div style="position:relative;"> -->
<!--                                                                             <div style="position:absolute;top:6px;left:132px;width:25px;background-color:#dcdcdc;opacity:0.6;height:50px;{!If(rec.pro.Time__c == true, 'display:none;', '')}"> -->
<!--                                                                             </div> -->
<!--                                                                             <apex:inputField value="{!rec.item.AdDayOfWeek__c}" id="AdDayOfWeek" style="margin:0px;padding:0px;float:right"/> -->
<!--                                                                         </div> -->
                                                                                                                                                
<!--                                                                         <div style="{!If(rec.pro.Time__c == true, '', 'display:none;')}"> -->
<!--                                                                             <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','AdDayOfWeek','4');return false;" onmouseover="setPosition('{!rec.position}');setColumn('AdDayOfWeek__c')" style="margin-top:2px"> -->
<!--                                                                                     <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /> -->
                                                                                    
<!--                                                                             </apex:commandLink> -->
<!--                                                                             <span></span> -->
<!--                                                                             <apex:commandLink onclick="forceCopyField('{!rec.position}','AdDayOfWeek','4');return false;" onmouseover="setPosition('{!rec.position}');setColumn('AdDayOfWeek__c')" style="margin-top:2px"> -->
<!--                                                                                     <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /> -->
                                                                                    
<!--                                                                             </apex:commandLink> -->
<!--                                                                         </div> -->
<!--                                                                     </td> -->
<!--                                                                     <td align="center" class="colContent" style="padding-left: 5px;width: 290px;">  -->
<!--                                                                         <div style="position:relative;"> -->
<!--                                                                             <div style="position:absolute;top:6px;left:132px;width:25px;background-color:#dcdcdc;opacity:0.6;height:50px;{!If(rec.pro.Time__c == true, 'display:none;', '')}"> -->
<!--                                                                             </div> -->
<!--                                                                             <apex:inputField value="{!rec.item.AdHourOfDay__c}" id="AdHourOfDay" style="margin:0px;padding:0px;float:right" /> -->
<!--                                                                         </div> -->
                                                                            
<!--                                                                             <div style="{!If(rec.pro.Time__c == true, '', 'display:none;')}"> -->
<!--                                                                                 <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','AdHourOfDay','4');return false;" onmouseover="setPosition('{!rec.position}');setColumn('AdHourOfDay__c')" style="margin-top:2px"> -->
<!--                                                                                         <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /> -->
                                                                                        
<!--                                                                                 </apex:commandLink> -->
<!--                                                                                 <span></span> -->
<!--                                                                                 <apex:commandLink onclick="forceCopyField('{!rec.position}','AdHourOfDay','4');return false;" onmouseover="setPosition('{!rec.position}');setColumn('AdHourOfDay__c')" style="margin-top:2px"> -->
<!--                                                                                         <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /> -->
                                                                                        
<!--                                                                                 </apex:commandLink> -->
<!--                                                                             </div> -->
<!--                                                                     </td> -->
                                                              <!--       <td align="center" class="colContent" style="padding-left: 5px;width: 140px;">
                                                                            <apex:inputField value="{!rec.item.AdKeyWords__c}" id="AdKeyWord" style="margin-top:2px;padding:0px;height:50px"/>
                                                                            <script>
                                                                                disableInputField('{!rec.position}', '{!rec.pro.Time__c}', 'AdKeyWord', 'myRepeat4');
                                                                            </script>
                                                                            
                                                                            <div style="{!If(rec.pro.Time__c == true, '', 'display:none;')}">
                                                                                <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','AdKeyWord','4');return false;" onmouseover="setPosition('{!rec.position}');setColumn('AdKeyWords__c')" style="margin-top:2px">
                                                                                        <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" />
                                                                                        
                                                                                </apex:commandLink>
                                                                                <span></span>
                                                                                <apex:commandLink onclick="forceCopyField('{!rec.position}','AdKeyWord','4');return false;" onmouseover="setPosition('{!rec.position}');setColumn('AdKeyWords__c')" style="margin-top:2px">
                                                                                        <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" />
                                                                                        
                                                                                </apex:commandLink>
                                                                            </div> 
                                                                    </td>
                                                                 -->    
                                                                     <td class="colContent"> </td>
                                                        
                                                            </tr>                       
                                                        </apex:repeat>  
                                         
                                            </table>
                                        </div>                                  
                                         <script>                                                                 
                                            $$('table.multiSelectPicklistTable tr.multiSelectPicklistRow select').each(function(i) { i.style.height = "55px";i.style.width = "130px"; });                           
                                           // setWidthDiv('mydev4');                                            
                                        </script>   
                                    </apex:tab>
                                 <!-- 2014-05-20 - GTCRM-635 - AdSales Automate Screenshots - Preview URL-->
                              <apex:tab label="Screenshot Url" name="tabname11" id="tabname11" style="padding:0px;margin:0px;border:0px;background-color:#F3F3DC">
                                    <div style="padding:0px;margin:0px;border:0px solid;overflow-x: auto;overflow-y:hidden;" id="mydev11">
                                <table cellpadding="0" cellspacing="0" width="100%">
                                    <tr id="tab10" style="height:64px;border-bottom:1px solid #E3DEB8;background-color:#F3F3EC">
                                        <td align="center" class="colHeader">Please enter site URL for Screenshots eg. http://www.gumtree.com/flats-and-houses-for-rent-offered</td>                                       
                                    </tr>
                                    <apex:repeat value="{!lDisplayRec}" var="rec" id="myRepeat11">
                                        <tr style="height:106px">
                                            <td align="center" class="colContent" style="padding-left: 5px;" width="500px">
                                                <apex:inputField value="{!rec.item.PreviewUrl__c}" id="preview" style="padding-left: 2px;width:500px;" />
                                    <!--                    <script>
                                                            disableInputField('{!rec.position}', '{!rec.pro.PreviewUrl__c}', 'preview', 'myRepeat11');
                                                        </script>  -->
                                     <!--                   <div style="{!If(rec.pro.PreviewUrl__c == true, '', 'display:none;')}"> -->
                                                            <apex:commandLink onclick="checkValidationCopyField('{!rec.position}','preview','11');return false;" onmouseover="setPosition('{!rec.position}');setColumn('PreviewUrl__c')" style="margin-top:2px">
                                                                <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" /></apex:commandLink> <span></span>
                                                            <apex:commandLink onclick="forceCopyField('{!rec.position}','preview','11');return false;" onmouseover="setPosition('{!rec.position}');setColumn('PreviewUrl__c')" style="margin-top:2px">
                                                              <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" /></apex:commandLink>
                                                        <!-- </div> -->
                                           </td>  
                                                        
                                        </tr>
                                    </apex:repeat>
                                </table>
                                    </div>
                              </apex:tab>
                              <!-- add new tab keyvalue-->
                              <apex:tab label="Test" name="tabname12" id="tabname12" style="padding:0px;margin:0px;border:0px;background-color:#F3F3DC">
                                    <div style="padding:0px;margin:0px;border:0px solid;overflow-x: auto;overflow-y:hidden;" id="mydev12">
                                <table cellpadding="0" cellspacing="0" width="100%">
                                    <tr id="tab10" style="height:64px;border-bottom:1px solid #E3DEB8;background-color:#F3F3EC">
                                        <td align="center" class="colHeader">DFP KeyValue Targeting</td>
                                        <td align="center" class="colHeader">&nbsp;</td>  
                                    </tr>
                                    <apex:repeat value="{!lDisplayRec}" var="rec" id="myRepeat12">
                                        <tr style="height:106px">
                                            <td align="center" class="colContent" style="padding-left: 5px;" >
                                                 <table cellspacing="0" cellpadding="0">
                                                    <tr>
                                                        <td>
                                                           <div > 
                                                            <apex:commandButton rendered="{!rec.isHasPreDefine}" id="btnNewKeyValue" value="New Key Value" onclick="openKeyValueconfiguration('{!rec.proId}','{!rec.item.id}',{!rec.position}); return false;" />
                                                          </div>
                                                         </td>
                                                         <td style="padding-left: 5px;">
                                                             <div style="{!If(rec.pro.Keywords__c == true, '', 'display:none;')}">
                                                                 <apex:commandLink onclick="doCopyForNewTargeting();return false;" onmouseover="setPosition('{!rec.position}');" style="margin-top:2px">
                                                                    <apex:image value="{!$Resource.Copy}" title="{!$Label.ColumnCopy}" />
                                                                </apex:commandLink>
                                                                <span></span>
                                                                <apex:commandLink onclick="doForceCopyForNewTargeting();return false;" onmouseover="setPosition('{!rec.position}');" style="margin-top:2px">
                                                                    <apex:image value="{!$Resource.forcecopy}" title="{!$Label.Force_Copy}" />
                                                                </apex:commandLink>
                                                            </div>
                                                         </td>
                                                    </tr>
                                                  </table>                                               
                                            </td>
                                            <td align="center" class="colContent" style="padding-left: 5px;">&nbsp;</td>
                                        </tr>
                                    </apex:repeat>
                                </table>
                                    </div>
                              </apex:tab>                      
                           </apex:tabPanel>
                        </td>
                    </tr>
                </table>
            </div>
            <script>
                if (navigator.userAgent.indexOf("Firefox") != -1) {
                    var elem = document.getElementById('myPage:myForm').elements;
                    for (var i = 0; i < elem.length; i++) {
                        if (elem[i].type == "textarea") {
                            var str = elem[i].id;
                            if (str.match(/LineDescription/gi) || str.match(/keyword/gi) || str.match(/finalKey/gi)) {
                                document.getElementById(str).rows = 2;
                            }

                        }
                    }

                }

                function closeMessage(pId) {
                    document.getElementById(pId).style.display = 'none';
                }

                var IE = document.all ? true : false;
                if (!IE) document.captureEvents(Event.MOUSEMOVE)
                 document.onmousemove = getMouseXY;
                var tempX = 0;
                var tempY = 0;

                function getMouseXY(e) {
                    if (IE) { // grab the x-y pos.s if browser is IE
                        tempX = event.clientX + document.body.scrollLeft;
                        tempY = event.clientY + document.body.scrollTop;
                    } else { // grab the x-y pos.s if browser is NS
                        tempX = e.pageX;
                        tempY = e.pageY;
                    }
                    if (tempX < 0) {
                        tempX = 0;
                    }
                    if (tempY < 0) {
                        tempY = 0;
                    }
                    return true;
                }

                function changeTextValue(helpText, lId, pId, left, top) {
                    var panelId = document.getElementById(pId);

                    tempX = tempX - 10;
                    tempY = tempY - 100;
                    panelId.style.display = 'block';
                    panelId.style.left = tempX + 'px';
                    panelId.style.top = tempY + 'px';
                    panelId.style.border = '1px solid orange';
                    panelId.style.padding = '2px 5px';
                    panelId.style.backgroundColor = '#fefdB9';
                    panelId.style.position = 'absolute';
                    panelId.style.fontWeight = 'normal';
                    panelId.style.textAlign = 'left';
                    panelId.style.whiteSpace = 'normal';
                    panelId.style.zIndex = 2000;

                    panelId.innerHTML = helpText.replace(/\n/gi, '<br/>');
                }
            </script>
            <!-- Block Button Page -->
            <br/>
            <div style="position:relative;displayinline;">
                <div style="text-align:left;position:absolute;">
                    <apex:outputLabel style="font-weight:bold;" value="{!disNumOfRecPerPage}" id="displayNumRec" />
                </div>
                <div style="text-align:right;padding-right:20px;">
                    <apex:commandButton value="{!$Label.Previous}" title="{!If(disablePre == true , '','{!$Label.Previous}')}" reRender="MyPageBlock" action="{!goPrevious}" status="status" disabled="{!disablePre}" styleclass="{!IF(disablePre == true ,'disableStyle', 'enableStyle2')}"
                    style="padding: 0 7px 3px;" /><span></span>

                    <apex:repeat value="{!numBtn}" var="num">
                        <apex:commandButton value="{!num}" action="{!gotoPage}" title="{!num}" reRender="MyPageBlock" status="status" disabled="{!IF(pageNum == num ,true, false)}" styleclass="{!IF(pageNum != num , 'btnNotDisplaying','enableStyle')}" style="{!IF(pageNum != num ,'padding: 0 7px 2px;','padding: 0 7px 3px;color:#FFFFFF;')}">
                            <apex:param name="pageNum" value="{!num}" assignTo="{!pageNum}" /></apex:commandButton> <span></span>

                    </apex:repeat>
                    <apex:commandButton value="{!$Label.Next}" title="{!IF(disableNext == true ,'','{!$Label.Next}')}" reRender="MyPageBlock" action="{!goNext}" status="status" disabled="{!disableNext}" styleclass="{!IF(disableNext == true ,'disableStyle','enableStyle2' )}"
                    style="padding: 0 7px 3px;" />
                </div>
            </div>
            <!-- End -->
            <script>
                onload();
            </script>
        </apex:pageBlock>
        <apex:outputPanel id="theWaitingProgress" >
              <apex:outputPanel rendered="{!isPollerMode}">
                 <c:Load BackColor="#efefef" borderColor="#efefef" borderSize="3" height="50px" width="180px" Message="Please, wait..." messageStyle="color:darkred;font-size:10pt;font-family:arial;font-weight:bold;" imageUrl="/img/loading.gif" />
             </apex:outputPanel>
        </apex:outputPanel>
        <apex:actionStatus id="status">
            <apex:facet name="start">
                <c:Load BackColor="#efefef" borderColor="#efefef" borderSize="3" height="50px" width="180px" Message="Please, wait..." messageStyle="color:darkred;font-size:10pt;font-family:arial;font-weight:bold;" imageUrl="/img/loading.gif" />
            </apex:facet>
        </apex:actionStatus>
        <div id="InlineEditDialog" class="overlayDialog inlineEditDialog" style="width:400px; top:40%; display: none; visibility: visible;margin-left: 340px">
            <div class="topRight">
                <div class="topLeft">
                    <img id="InlineEditDialogX" class="dialogClose" src="/s.gif" onclick="cancel();" title="{!$Label.Close}" onmouseout="this.className = 'dialogClose'" onmouseover="this.className = 'dialogCloseOn'" />
                     <h2 id="InlineEditDialogTitle">Editable Text</h2>

                </div>
            </div>
            <div class="middle">
                <div id="InlineEditDialogContent" class="innerContent">
                    <div class="activeField">
                        <div class="inlineEditCompoundDiv" align="center">
                            <div style="border:0px solid #888888;" id="content"></div>
                        </div>
                    </div>
                    <div></div>
                    <div style="display: none;"></div>
                    <div class="buttons">
                        <apex:CommandButton value="{!$Label.Button_Ok}" title="{!$Label.Button_Ok}" onclick="checkValidationSplit();cancel();return false;" />
                        <apex:CommandButton value="{!$Label.Button_Cancel}" title="{!$Label.Button_Cancel}" onclick="cancel();return false;" />
                    </div>
                </div>
                <div class="bottomRight">
                    <div class="bottomLeft"></div>
                </div>
            </div>
        </div>
        <div id="InlineCopyDialog" class="overlayDialog inlineEditDialog" style="width:400px; top:40%; display: none; visibility: visible;margin-left: 340px">
            <div class="topRight">
                <div class="topLeft">
                    <img id="InlineCopyDialogX" class="dialogClose" src="/s.gif" onclick="cancel();" title="{!$Label.Close}" onmouseout="this.className = 'dialogClose'" onmouseover="this.className = 'dialogCloseOn'" />
                     <h2 id="InlineCopyDialogTitle">Editable Text</h2>

                </div>
            </div>
            <div class="middle">
                <div id="InlineCopyDialogContent" class="innerContent">
                    <div class="activeField">
                        <div class="inlineCopyCompoundDiv" align="center">
                            <div style="border:0px solid #888888;" id="contentCopy"></div>
                        </div>
                    </div>
                    <div></div>
                    <div style="display: none;"></div>
                    <div class="buttons">
                        <apex:CommandButton value="{!$Label.Button_Ok}" title="{!$Label.Button_Ok}" onclick="checkValidationCopy();cancelCx();return false;" />
                        <apex:CommandButton value="{!$Label.Button_Cancel}" title="{!$Label.Button_Cancel}" onclick="cancelCx();return false;" />
                    </div>
                </div>
                <div class="bottomRight">
                    <div class="bottomLeft"></div>
                </div>
            </div>
        </div>
        <div id="overlayBackground" class="overlayBackground" style="width: 100%; height: 100%; display: none; left: 0; top: 0px"></div>
    </apex:form>
    <script>
        if (!isIE()) {
            var ag = document.getElementById('header');
            ag.style.height = '63px';
            var hr = document.getElementById('myPage:myForm:uAgent');
            hr.value = '63px';
        }
        
        function openKeyValueconfiguration(proId,oppItemId,pos){
               var width  = 850;
                var height = 640;
                var left   = (screen.width  - width)/2;
                var top    = (screen.height - height)/2;
                var params = 'width='+width+', height='+height;
                params += ', top='+top+', left='+left;
                params += ', directories=no';
                params += ', location=no';
                params += ', menubar=no';
                params += ', resizable=no';
                params += ', scrollbars=no';
                params += ', status=no';
                params += ', toolbar=no';
                var url = '';
                pos = checkCurrentPosition(pos);
                var oppId = '{!Opportunity.Id}';
                oppId = oppId==''? '{!$CurrentPage.parameters.mcId}' : oppId;
                var vTargetId = document.getElementById('myPage:myForm:MyPageBlock:myRepeat6:'+ pos +':hidTargetId');
                 url = ('{!$Site.Prefix}/apex/targetingconfiguration?oppItemId='+ oppItemId + '&targetId='+  vTargetId.value  + '&proId=' + proId +'&oppId='+ oppId +'&pos='+ pos);
                 var newwin=window.open(url,'KeyValue', params);
                if (window.focus) {newwin.focus();}
        
        }
        
        function openTargetingTreePopup(fromId, hiddenId, source) {
            
            //alert('fromId:'+fromId+'-->hiddenId:'+hiddenId+'-->source:'+source);
            
            var width = 850;
            var height = 640;
            var left = (screen.width - width) / 2;
            var top = (screen.height - height) / 2;
            var params = 'width=' + width + ', height=' + height;
            params += ', top=' + top + ', left=' + left;
            params += ', directories=no';
            params += ', location=no';
            params += ', menubar=no';
            params += ', resizable=no';
            params += ', scrollbars=no';
            params += ', status=no';
            params += ', toolbar=no';
            var url = '';
            var vTargetId = document.getElementById(hiddenId);
            if (source == 'TargetingButton') {
                var linkProId = hiddenId.replace('hidTargetId', 'hidProId');
                var proId = document.getElementById(linkProId);
                url = '/apex/apex/ContentHierarchyPage?fromId=' + fromId + '&targetId=' + vTargetId.value + '&proId=' + proId.value;
            }
            
            if (source == 'KeyValueButton') {
                var linkAvail = hiddenId;
                linkAvail = linkAvail.replace('hidTargetId', 'hidAvaiKV');
                var avaiKV = document.getElementById(linkAvail);
                var kvStringId = hiddenId;
                kvStringId = kvStringId.replace('hidTargetId', 'keyvalueString');
                var kvString = document.getElementById(kvStringId);
                
                 //alert('avaiKV:'+avaiKV?avaiKV:avaiKV.value);
                if (avaiKV.value != 'None' && avaiKV.value != 'none') {

                    url = '/apex/KeyValueHierachyPage?fromId=' + fromId + '&targetId=' + vTargetId.value + '&avaiKV=' + avaiKV.value + '&kvString=' + kvString.value;
                } else {
                    alert('No Key Values available for this product.');
                }
                 
            }
            if (source == 'AreacodesButton') {
                url = '/apex/TreeAreaCodes?fromId=' + fromId + '&targetId=' + vTargetId.value + '&hidId=' + hiddenId;
            }
            if (source == 'CitiesButton') {
                url = '/apex/CitiesHierachyPage?fromId=' + fromId + '&targetId=' + vTargetId.value + '&hidId=' + hiddenId;
            }

            if (source == 'CountriesButton') {
                url = '/apex/TreeCountries?fromId=' + fromId + '&targetId=' + vTargetId.value + '&hidId=' + hiddenId;
            }
              
            var newwin = window.open(url, 'TreeProduct', params);
            if (window.focus) {
                newwin.focus();
            }
            
        }
    </script>
</apex:page>